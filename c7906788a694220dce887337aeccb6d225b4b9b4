{
  "comments": [
    {
      "key": {
        "uuid": "09a5f45c_e597114d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1306837
      },
      "writtenOn": "2019-11-06T06:00:46Z",
      "side": 1,
      "message": "since?",
      "range": {
        "startLine": 11,
        "startChar": 18,
        "endLine": 11,
        "endChar": 24
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2654285a_45ea00a6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "09a5f45c_e597114d",
      "range": {
        "startLine": 11,
        "startChar": 18,
        "endLine": 11,
        "endChar": 24
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6364137_c33478f5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1304263
      },
      "writtenOn": "2019-11-05T12:17:37Z",
      "side": 1,
      "message": "share the same?",
      "range": {
        "startLine": 12,
        "startChar": 44,
        "endLine": 12,
        "endChar": 55
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "534ca288_ce30fead",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "This description is gone.",
      "parentUuid": "d6364137_c33478f5",
      "range": {
        "startLine": 12,
        "startChar": 44,
        "endLine": 12,
        "endChar": 55
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ab4f2b78_c670a31a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 1304263
      },
      "writtenOn": "2019-11-05T12:17:37Z",
      "side": 1,
      "message": "\"the right\" is ok? or it implies something still not right?",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 12
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c8f85a65_8f68bd0e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 1306837
      },
      "writtenOn": "2019-11-06T06:00:46Z",
      "side": 1,
      "message": "an",
      "range": {
        "startLine": 13,
        "startChar": 34,
        "endLine": 13,
        "endChar": 35
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "deff69af_a3784f45",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "This description is gone.",
      "parentUuid": "ab4f2b78_c670a31a",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 12
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1611472b_00c540b4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 13,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "This description is gone.",
      "parentUuid": "c8f85a65_8f68bd0e",
      "range": {
        "startLine": 13,
        "startChar": 34,
        "endLine": 13,
        "endChar": 35
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "912bdd9c_bd0085f3",
        "filename": "services/core/java/com/android/server/connectivity/PermissionMonitor.java",
        "patchSetId": 1
      },
      "lineNbr": 276,
      "author": {
        "id": 1306837
      },
      "writtenOn": "2019-11-06T06:00:46Z",
      "side": 1,
      "message": "I would prefer old logic that reduce nested logic.\nSee go/tott/553",
      "range": {
        "startLine": 276,
        "startChar": 8,
        "endLine": 276,
        "endChar": 48
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9aceffae_bad25c2f",
        "filename": "services/core/java/com/android/server/connectivity/PermissionMonitor.java",
        "patchSetId": 1
      },
      "lineNbr": 276,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "This code is gone.",
      "parentUuid": "912bdd9c_bd0085f3",
      "range": {
        "startLine": 276,
        "startChar": 8,
        "endLine": 276,
        "endChar": 48
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c52c2c0a_a67e45e8",
        "filename": "services/core/java/com/android/server/connectivity/PermissionMonitor.java",
        "patchSetId": 1
      },
      "lineNbr": 278,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2019-11-05T16:02:06Z",
      "side": 1,
      "message": "This looks like it will send lots of IPCs to the package manager and could get expensive. If all we\u0027re trying to determine here is \"does this uid have CHANGE_NETWORK_STATE, NETWORK_STACK, or CONNECTIVITY_USE_RESTRICTED_NETWORKS\", then can we just use mContext.checkPermission() to check whether the caller has those permissions?\n\nOr, if we can\u0027t use that: isn\u0027t this information already available in mApps? The documentation for mApps says that it maps every UID to either true (CONNECTIVITY_USE_RESTRICTED_NETWORKS) or false (CHANGE_NETWORK_STATE). So perhaps we could use it. But we would need to check if mApps is guaranteed to be populated at the time that MultipathPolicyTracker starts running.",
      "range": {
        "startLine": 278,
        "startChar": 12,
        "endLine": 278,
        "endChar": 39
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1d556443_d52dc45b",
        "filename": "services/core/java/com/android/server/connectivity/PermissionMonitor.java",
        "patchSetId": 1
      },
      "lineNbr": 278,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "If we use Context#checkPermission() to check these three permissions, we will lose the backward compatibility in hasRestrictedNetworkPermission().\nBoth checking permission(PermissionMonitor) and registering a callback(MultipathPolicyTracker) are happened after received system ready. If we want to ensure that mApps is populated first, we need to adjust the code flow that move mPermissionMonitor.startMonitoring() into EVENT_SYSTEM_READY just before do mMultipathPolicyTracker.start().\nHowever, mApps doesn\u0027t check the NETWORK_STACK, need to check it further if we want to use mApps. After discussed with Jean, moving NETWORK_STACK check into hasRestrictedNetworkPermission() is a simple and reasonable solution.",
      "parentUuid": "c52c2c0a_a67e45e8",
      "range": {
        "startLine": 278,
        "startChar": 12,
        "endLine": 278,
        "endChar": 39
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "afbe336e_4494d576",
        "filename": "tests/net/java/com/android/server/connectivity/PermissionMonitorTest.java",
        "patchSetId": 1
      },
      "lineNbr": 162,
      "author": {
        "id": 1304263
      },
      "writtenOn": "2019-11-05T12:17:37Z",
      "side": 1,
      "message": "Nit: Will it be better to name with SystemPartition like packageInfoWithPermissionsInSys() since this function is limited with PARTITION_SYSTEM, not a general one.\n\nAlso, do you want to just use addPackage() in l.603? Actually, the naming is easier to understand for me in your case.",
      "range": {
        "startLine": 162,
        "startChar": 31,
        "endLine": 162,
        "endChar": 57
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "65d04609_5f65bba2",
        "filename": "tests/net/java/com/android/server/connectivity/PermissionMonitorTest.java",
        "patchSetId": 1
      },
      "lineNbr": 162,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "Renamed to systemPackageInfoWithPermissions",
      "parentUuid": "afbe336e_4494d576",
      "range": {
        "startLine": 162,
        "startChar": 31,
        "endLine": 162,
        "endChar": 57
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bd30afa3_da0dd511",
        "filename": "tests/net/java/com/android/server/connectivity/PermissionMonitorTest.java",
        "patchSetId": 1
      },
      "lineNbr": 239,
      "author": {
        "id": 1304263
      },
      "writtenOn": "2019-11-05T12:17:37Z",
      "side": 1,
      "message": "Nit: space",
      "range": {
        "startLine": 239,
        "startChar": 9,
        "endLine": 239,
        "endChar": 10
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a7f110fb_f77a6940",
        "filename": "tests/net/java/com/android/server/connectivity/PermissionMonitorTest.java",
        "patchSetId": 1
      },
      "lineNbr": 239,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "This code is gone.",
      "parentUuid": "bd30afa3_da0dd511",
      "range": {
        "startLine": 239,
        "startChar": 9,
        "endLine": 239,
        "endChar": 10
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2d78eb63_b29fa8cf",
        "filename": "tests/net/java/com/android/server/connectivity/PermissionMonitorTest.java",
        "patchSetId": 1
      },
      "lineNbr": 257,
      "author": {
        "id": 1304263
      },
      "writtenOn": "2019-11-05T12:17:37Z",
      "side": 1,
      "message": "Nit: I think you do not need to do this every time. You do not need to re-generate that every time, right?\n\nsomething like:\n\nPackageInfo package1 \u003d packageInfoWithPermissions();\nPackageInfo package2 \u003d packageInfoWithPermissions();\n\nassertFalse(hasBgPermission(VERSION_P, MOCK_UID2, package1,package2));\nassertFalse(hasBgPermission(VERSION_P, MOCK_UID2, package1,\n       packageInfoWithPermissions(CHANGE_WIFI_STATE)));\nassertTrue(hasBgPermission(VERSION_P, MOCK_UID2, package1,\n                packageInfoWithPermissions(CHANGE_NETWORK_STATE)));\n         :",
      "range": {
        "startLine": 257,
        "startChar": 58,
        "endLine": 257,
        "endChar": 86
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1bc0a57d_81845a8c",
        "filename": "tests/net/java/com/android/server/connectivity/PermissionMonitorTest.java",
        "patchSetId": 1
      },
      "lineNbr": 257,
      "author": {
        "id": 1308473
      },
      "writtenOn": "2019-11-08T07:59:42Z",
      "side": 1,
      "message": "This code is gone.",
      "parentUuid": "2d78eb63_b29fa8cf",
      "range": {
        "startLine": 257,
        "startChar": 58,
        "endLine": 257,
        "endChar": 86
      },
      "revId": "c7906788a694220dce887337aeccb6d225b4b9b4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}