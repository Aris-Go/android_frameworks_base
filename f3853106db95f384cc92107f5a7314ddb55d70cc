{
  "comments": [
    {
      "key": {
        "uuid": "1cb6df40_53391dd0",
        "filename": "packages/Tethering/src/com/android/networkstack/tethering/BpfCoordinator.java",
        "patchSetId": 11
      },
      "lineNbr": 765,
      "author": {
        "id": 1308504
      },
      "writtenOn": "2020-06-16T11:04:13Z",
      "side": 1,
      "message": "If get mIpv6ForwardingRules is really necessary for testing but it won\u0027t use in tethering module itself, I would suggest to have a init method and override it in testing:\n\nIn BpfCoordinator.java\n    public BpfCoordinator(@NonNull Dependencies deps) {\n        mDeps \u003d deps;\n        mHandler \u003d mDeps.getHandler();\n        mNetd \u003d mDeps.getNetd();\n        mLog \u003d mDeps.getSharedLog().forSubComponent(TAG);\n+       mIpv6ForwardingRules \u003d NewForwardingRules();\n    }\n\n    public HashMap\u003cIpServer, LinkedHashMap\u003cInet6Address, Ipv6ForwardingRule\u003e\u003e initIpv6ForwardingRules() {\n        return new LinkedHashMap\u003c\u003e();\n    }\n\nIn BpfCorrdinatorTest.java\n    class MockBpfCoordinator extends BpfCoordinator {\n        public mIpv6ForwardingRulesForTesting;\n\n        @Override\n        public HashMap\u003cIpServer, LinkedHashMap\u003cInet6Address, Ipv6ForwardingRule\u003e\u003e initIpv6ForwardingRules() {\n            mIpv6ForwardingRulesForTesting \u003d super.initIpv6ForwardingRules();\n            return mIpv6ForwardingRulesForTesting;\n        }        \n    }\n\nThen you can use mIpv6ForwardingRulesForTesting from MockBpfCoordinator",
      "range": {
        "startLine": 758,
        "startChar": 0,
        "endLine": 765,
        "endChar": 5
      },
      "revId": "f3853106db95f384cc92107f5a7314ddb55d70cc",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e9987fa3_98bc920f",
        "filename": "packages/Tethering/src/com/android/networkstack/tethering/BpfCoordinator.java",
        "patchSetId": 11
      },
      "lineNbr": 765,
      "author": {
        "id": 1308504
      },
      "writtenOn": "2020-06-16T11:08:23Z",
      "side": 1,
      "message": "Ohh, sorry for typo.\nIn BpfCoordinator constructor.\nIt should be\n+       mIpv6ForwardingRules \u003d initIpv6ForwardingRules();",
      "parentUuid": "1cb6df40_53391dd0",
      "range": {
        "startLine": 758,
        "startChar": 0,
        "endLine": 765,
        "endChar": 5
      },
      "revId": "f3853106db95f384cc92107f5a7314ddb55d70cc",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8675e74a_d52a04c5",
        "filename": "packages/Tethering/src/com/android/networkstack/tethering/BpfCoordinator.java",
        "patchSetId": 11
      },
      "lineNbr": 765,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2020-06-16T11:18:20Z",
      "side": 1,
      "message": "That would work too, though it\u0027s a bit strange for the code to rely on a dependencies object to create its own member variables. Either seems acceptable here.",
      "parentUuid": "e9987fa3_98bc920f",
      "range": {
        "startLine": 758,
        "startChar": 0,
        "endLine": 765,
        "endChar": 5
      },
      "revId": "f3853106db95f384cc92107f5a7314ddb55d70cc",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}