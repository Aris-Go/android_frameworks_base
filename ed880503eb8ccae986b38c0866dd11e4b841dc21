{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "ba13893c_6a5e2fb4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1650177
      },
      "writtenOn": "2023-09-11T02:27:59Z",
      "side": 1,
      "message": "When will this happen? And can you please file a bug with reproduce steps for tracking purpose?\n\nAlso, why doesn\u0027t it have the same issue with `onTaskInfoChanged`?",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25c3a61d_b8a640f3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-11T13:23:46Z",
      "side": 1,
      "message": "Stack Informationï¼š\n08-09 06:50:47.084 18900 19072 E AndroidRuntime: FATAL EXCEPTION: wmshell.main\n08-09 06:50:47.084 18900 19072 E AndroidRuntime: Process: com.android.systemui, PID: 18900\n08-09 06:50:47.084 18900 19072 E AndroidRuntime: java.lang.NullPointerException: Attempt to invoke virtual method \u0027android.app.ActivityManager$RunningTaskInfo android.window.TaskAppearedInfo.getTaskInfo()\u0027 on a null object reference\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at com.android.wm.shell.ShellTaskOrganizer.onTaskVanished(go/retraceme 78832d3a4a201f097042b1ea15a2157c500caa6a711ff3f53714444fb9aead7c:110)\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at android.window.TaskOrganizer$1.lambda$onTaskVanished$5(TaskOrganizer.java:380)\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at android.window.TaskOrganizer$1.$r8$lambda$cnLAmEuLf_BQ_jFuhQbGGs5ghXo(Unknown Source:0)\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at android.window.TaskOrganizer$1$$ExternalSyntheticLambda14.run(Unknown Source:4)\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at android.os.Handler.handleCallback(Handler.java:958)\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at android.os.Handler.dispatchMessage(Handler.java:99)\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at android.os.Looper.loopOnce(Looper.java:222)\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at android.os.Looper.loop(Looper.java:314)\n08-09 06:50:47.084 18900 19072 E AndroidRuntime:     at android.os.HandlerThread.run(HandlerThread.java:67)\n\n\nThere is also a similar issue on onTaskInfoChanged. In 2021, Xiaomi fixed it and I thought it had already been released.\nJust read: The repair code did not actually enter the version. If the change can be included in the version, will the onTaskInfoChanged issue be submitted separately or modified together?",
      "parentUuid": "ba13893c_6a5e2fb4",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ffa86c57_c2da8497",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1650177
      },
      "writtenOn": "2023-09-11T13:32:32Z",
      "side": 1,
      "message": "Is there a way to reproduce locally?\n\n`onTaskInfoChanged` and `onTaskVanished` should be dispatched after `onTaskAppeared`. If the NPE happens, it means there is something wrong with the `onTaskAppeared`. \n\nCan you please debug on that instead? Otherwise this may just cover the root issue.",
      "parentUuid": "25c3a61d_b8a640f3",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "abc1f0ba_9547cb00",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1650177
      },
      "writtenOn": "2023-09-11T13:34:26Z",
      "side": 1,
      "message": "Please file a bug to track this.",
      "parentUuid": "ffa86c57_c2da8497",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "daccad75_f10628c7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-12T06:46:38Z",
      "side": 1,
      "message": "bug:300019951",
      "parentUuid": "abc1f0ba_9547cb00",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "507d6cd3_c992b64e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1650177
      },
      "writtenOn": "2023-09-12T07:06:17Z",
      "side": 1,
      "message": "Can you please debug to provide more info on why `onTaskAppeared` was not sent before `onTaskInfoChanged` and `onTaskVanished`? Otherwise this may just cover the root issue.",
      "parentUuid": "daccad75_f10628c7",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a6fb2014_87e37805",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-13T03:31:24Z",
      "side": 1,
      "message": "Stability testing issues, non essential issues, difficult to debug",
      "parentUuid": "507d6cd3_c992b64e",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6990d143_d7f416ad",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1010211
      },
      "writtenOn": "2023-09-13T04:18:28Z",
      "side": 1,
      "message": "I agree with Chris, we rely on receiving the signals in parity (appeared(1), info changed(*), vanished(1)), and if that\u0027s not happening then we should try to understand how the race manifests to see if we can patch it robustly.  \n\nCould you try logging in TaskOrganizerController where we send these calls, and on the shell side as well, and then we can see what\u0027s happening?",
      "parentUuid": "a6fb2014_87e37805",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "311d1d5a_2c34f7ed",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-13T06:31:57Z",
      "side": 1,
      "message": "Occasional issue, unable to simulate MTBF testing environment here, we are currently unable to log in to TaskOrganizerController",
      "parentUuid": "6990d143_d7f416ad",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "df0189af_e52b19c6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1650177
      },
      "writtenOn": "2023-09-13T06:40:56Z",
      "side": 1,
      "message": "Our suggestion is to add some logging in TaskOrganizerController, and continue monitoring the result of your stability testing, so that you can get more info at the next time this happens.\n\nOtherwise, with this change, although it will silent the NPE, the root cause will still there, and can cause other UI issue that is harder to catch.",
      "parentUuid": "311d1d5a_2c34f7ed",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8d4a05ea_6c28ba09",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-14T03:27:26Z",
      "side": 1,
      "message": "Excuse me: Add a log. What do you mean: inside the onTaskVanished function in the TaskOrganizerController or where the onTaskVanished function is called? Is it adding log printing stack information?",
      "parentUuid": "df0189af_e52b19c6",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2f0c1de1_829a50db",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1650177
      },
      "writtenOn": "2023-09-14T03:37:09Z",
      "side": 1,
      "message": "In `TaskOrganizerController` (which is running in system server), there are already some logging in `onTaskAppeared/Vanished/InfoChanged` with `WM_DEBUG_WINDOW_ORGANIZER`, you can just turn it on.\n\nSimilar in `ShellTaskOrganizer`, there are some logging as well in `onTaskAppeared/Vanished/InfoChanged` with `WM_SHELL_TASK_ORG`, you can also turn it on.\n\nThen monitoring the next crash from your stability testing. Hopefully we can learn more about the root cause from those log.",
      "parentUuid": "8d4a05ea_6c28ba09",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac65d927_968a2356",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-15T10:06:51Z",
      "side": 1,
      "message": "MTBF pressure testing is in progress.",
      "parentUuid": "2f0c1de1_829a50db",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d162288_1f91868d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-22T11:32:28Z",
      "side": 1,
      "message": "The log switch has been turned on and has not yet been replicated",
      "parentUuid": "ac65d927_968a2356",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6f52ecad_1d87e6f0",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-26T08:16:01Z",
      "side": 1,
      "message": "After turning on the log switch, it has not yet replicated, and the testing project has been encapsulated, leaving no resources for pressure testing. May I ask if this patch still needs to be merged? Thank you.",
      "parentUuid": "7d162288_1f91868d",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5a80c158_35809f60",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1650177
      },
      "writtenOn": "2023-09-26T09:07:27Z",
      "side": 1,
      "message": "Thanks for trying to add more log!\n\nI don\u0027t think we should merge this because it may cover the root cause. Please feel free to reopen the bug if the issue happens again.",
      "parentUuid": "6f52ecad_1d87e6f0",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "46db2e1b_8c82f345",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-26T12:35:07Z",
      "side": 1,
      "message": "Thank you for your suggestion.",
      "parentUuid": "5a80c158_35809f60",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 40
      },
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "06e054c3_5d356cfb",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 1650177
      },
      "writtenOn": "2023-09-12T07:06:17Z",
      "side": 1,
      "message": "Please add:\n```\nBug: 300019951\n```",
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "735ee7a4_f8fbca96",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 11,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-22T11:33:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "06e054c3_5d356cfb",
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "76c39923_493c2ceb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 2010302
      },
      "writtenOn": "2023-09-11T02:18:52Z",
      "side": 1,
      "message": "I would like invite you to review this change, thank you!",
      "revId": "ed880503eb8ccae986b38c0866dd11e4b841dc21",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}