{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "14b6623c_6bb16180",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1851100
      },
      "writtenOn": "2024-02-29T10:56:25Z",
      "side": 1,
      "message": "Hi Deeraj, \n\nI\u0027m confused how the framework outside of HdmiControlService calls setStreamVolume during an ARC long press (it should only call adjustStreamVolume). I couldn\u0027t find KeyPolicyManager in the framework - is it custom code?",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4c2acce8_9b969ea6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 2066470
      },
      "writtenOn": "2024-02-29T13:51:54Z",
      "side": 1,
      "message": "Yes KeyPolicyManager is a custom code. KeyPolicyManager is a service overrides behaviors of input keys and handles these key events before they are enqueued/dispatched to the system.",
      "parentUuid": "14b6623c_6bb16180",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9cd51a5e_6e4441f0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 2066470
      },
      "writtenOn": "2024-02-29T13:52:30Z",
      "side": 1,
      "message": "Accidently marked as resolved earlier.",
      "parentUuid": "4c2acce8_9b969ea6",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25cc8d50_2f2767e6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1851100
      },
      "writtenOn": "2024-02-29T16:35:13Z",
      "side": 1,
      "message": "It\u0027s currently intentional that setStreamVolume sets volume immediately when using ARC, unlike adjustStreamVolume. But I agree that in the long run, it might be better for it to behave like adjustStreamVolume - rely on HdmiControlService to update stream volume, instead of doing it immediately. \n\nThe complete implementation would be more complicated than this patch though, because it requires changing HdmiControlService as well, and possibly changing the API for registering absolute volume listeners.\n\nI\u0027ll discuss this with the Audio team.",
      "parentUuid": "9cd51a5e_6e4441f0",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c11c7ed4_474c7562",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 2066470
      },
      "writtenOn": "2024-03-01T10:39:26Z",
      "side": 1,
      "message": "Thanks for the response. is there any other info required from us or do you suggest any alternatives to try out ?",
      "parentUuid": "25cc8d50_2f2767e6",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0c1f7827_1aa5d9ac",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1851100
      },
      "writtenOn": "2024-03-05T13:14:09Z",
      "side": 1,
      "message": "In general, I would recommend not using setStreamVolume when using CEC volume - it only works when the connected CEC speaker supports \u003cSet Audio Volume Level\u003e, which is not often. \n\nThis is why the default framework behavior on volume key press is to call adjustStreamVolume instead, which sends the much more widely supported \u003cUser Control Pressed\u003e.",
      "parentUuid": "c11c7ed4_474c7562",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7b04d993_7f6ab53b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 2066470
      },
      "writtenOn": "2024-03-06T10:04:06Z",
      "side": 1,
      "message": "Thanks Yan, before closing\n\nCan you confirm our understanding ?\n\n- Recommendation is to use adjustStreamVolume instead of setStreamVolume for key presses from KeyPolicyManager.\n- Per earlier comment, in the long run setStreamVolume might need to be updated and Google plans to have internal discussions with audio team regarding the same.\nShould we file any bug for tracking this ?\n- Should we plan to abandon this gerrit ?",
      "parentUuid": "0c1f7827_1aa5d9ac",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac157c81_566bb6bd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1851100
      },
      "writtenOn": "2024-03-06T10:28:38Z",
      "side": 1,
      "message": "That\u0027s pretty much correct. Some clarifications:\n\n- Yes, we recommend adjustStreamVolume over setStreamVolume when using CEC volume - regardless of whether we change setStreamVolume in the way I proposed. But if you want to use setStreamVolume where possible, it\u0027s reliable when using CEC volume when the audio output device uses volume behavior DEVICE_VOLUME_BEHAVIOR_ABSOLUTE - this indicates that we can send \u003cSet Audio Volume Level\u003e.\n\n- There\u0027s need to file a bug; I\u0027ve already done so internally. But if you\u0027d like to follow the issue you can file one and I\u0027ll make sure it\u0027s updated when the internal one is resolved. The proper fix might take a while though, as it\u0027s a relatively low impact issue.\n\n- You should abandon this Gerrit, as the complete fix needs significant changes elsewhere in the framework.\n\nLet me know if you have any other questions.",
      "parentUuid": "7b04d993_7f6ab53b",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "56cbb817_43eeefa3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 2066470
      },
      "writtenOn": "2024-03-12T12:40:49Z",
      "side": 1,
      "message": "Thanks for confirming.\nRaised https://issuetracker.google.com/issues/329138758 for tracking the issue.",
      "parentUuid": "ac157c81_566bb6bd",
      "revId": "4200f60c3b215953612c7bd4238470f2fba6ac8f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}