{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "438e09d0_ee199ca9",
        "filename": "core/java/android/provider/Settings.java",
        "patchSetId": 2
      },
      "lineNbr": 18156,
      "author": {
        "id": 1480715
      },
      "writtenOn": "2023-09-14T16:20:52Z",
      "side": 1,
      "message": "Why should this data be kept in SettingsProvider; why not just use app data? What is your use case? Can the existing types of settings accommodate your usage?\n\nOn the other hand, does it mean that App A can see App B\u0027s setting as long as App A has READ_PACKAGE_SETTINGS permission? That means App A can know that App B is installed, which can violate the package visibility restriction.",
      "range": {
        "startLine": 18156,
        "startChar": 7,
        "endLine": 18156,
        "endChar": 67
      },
      "revId": "177d23b958b643ce216d972c6c5756cdbb354781",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6adddd37_de55c86c",
        "filename": "core/java/android/provider/Settings.java",
        "patchSetId": 2
      },
      "lineNbr": 18156,
      "author": {
        "id": 2037182
      },
      "writtenOn": "2023-09-14T16:28:54Z",
      "side": 1,
      "message": "The main use case here is Notification Settings. Those are part of the device level settings, but should be set per package. In theory, one can use the system settings for this and create an abstraction on top of this to manage the keys per package. But that has the potential of duplicating this logic over and over again for other settings that are app specific, but on a device level.\nAs for the second question - this permission is a system permission. So only system apps can access it, not just any 3rd party app.",
      "parentUuid": "438e09d0_ee199ca9",
      "range": {
        "startLine": 18156,
        "startChar": 7,
        "endLine": 18156,
        "endChar": 67
      },
      "revId": "177d23b958b643ce216d972c6c5756cdbb354781",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5d0cac24_b6dbe8a6",
        "filename": "core/java/android/provider/Settings.java",
        "patchSetId": 2
      },
      "lineNbr": 18156,
      "author": {
        "id": 1480715
      },
      "writtenOn": "2023-09-14T17:51:54Z",
      "side": 1,
      "message": "I\u0027m still not very clear about the use cases. Currently system settings already has a notion of owning package (`setting.packageName`). What\u0027s the part of logic added in package settings that is currently missing in system settings? If there\u0027s such mismatch, can it be just be added to the existing system settings, instead of creating a new class?",
      "parentUuid": "6adddd37_de55c86c",
      "range": {
        "startLine": 18156,
        "startChar": 7,
        "endLine": 18156,
        "endChar": 67
      },
      "revId": "177d23b958b643ce216d972c6c5756cdbb354781",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e511f105_da66052a",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
        "patchSetId": 2
      },
      "lineNbr": 3073,
      "author": {
        "id": 1480715
      },
      "writtenOn": "2023-09-14T16:20:52Z",
      "side": 1,
      "message": "Iterating through the list of all the apps at boot can cause a significant delay if there are lots of packages installed. I see that you are already doing some cleaning up when a package is installed. Why is there still a need to do pruning during boot? Is it for system packages removed during OTA?",
      "range": {
        "startLine": 3073,
        "startChar": 21,
        "endLine": 3073,
        "endChar": 55
      },
      "revId": "177d23b958b643ce216d972c6c5756cdbb354781",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "446f96b1_33aa371a",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
        "patchSetId": 2
      },
      "lineNbr": 3073,
      "author": {
        "id": 2037182
      },
      "writtenOn": "2023-09-14T16:28:54Z",
      "side": 1,
      "message": "Exactly - OTA can change the list of apps. If there is a cleaner way to do this it would be good.",
      "parentUuid": "e511f105_da66052a",
      "range": {
        "startLine": 3073,
        "startChar": 21,
        "endLine": 3073,
        "endChar": 55
      },
      "revId": "177d23b958b643ce216d972c6c5756cdbb354781",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f51cb612_b7c471bb",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
        "patchSetId": 2
      },
      "lineNbr": 3073,
      "author": {
        "id": 1480715
      },
      "writtenOn": "2023-09-14T17:51:54Z",
      "side": 1,
      "message": "In that case, you can call it under `mPackageManager.isDeviceUpgrading()`",
      "parentUuid": "446f96b1_33aa371a",
      "range": {
        "startLine": 3073,
        "startChar": 21,
        "endLine": 3073,
        "endChar": 55
      },
      "revId": "177d23b958b643ce216d972c6c5756cdbb354781",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "58806d60_5a8f7285",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
        "patchSetId": 2
      },
      "lineNbr": 3102,
      "author": {
        "id": 1480715
      },
      "writtenOn": "2023-09-14T17:51:54Z",
      "side": 1,
      "message": "It might be more efficient to loop through the list of package names in `packageSettings.getSettingNamesLocked()` and check if the packages are still installed with `mPackageManager.getPackageUid` or `getPackageInfo`, instead of the other way around.",
      "range": {
        "startLine": 3081,
        "startChar": 16,
        "endLine": 3102,
        "endChar": 17
      },
      "revId": "177d23b958b643ce216d972c6c5756cdbb354781",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1da6a720_7b4c4837",
        "filename": "packages/SettingsProvider/src/com/android/providers/settings/SettingsProvider.java",
        "patchSetId": 2
      },
      "lineNbr": 3122,
      "author": {
        "id": 1480715
      },
      "writtenOn": "2023-09-14T17:51:54Z",
      "side": 1,
      "message": "`packageName + \"/\"` to be more precise (in case two packages start with the same string)",
      "range": {
        "startLine": 3122,
        "startChar": 40,
        "endLine": 3122,
        "endChar": 51
      },
      "revId": "177d23b958b643ce216d972c6c5756cdbb354781",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}