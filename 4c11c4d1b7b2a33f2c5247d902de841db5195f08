{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "0a76cc98_3944af55",
        "filename": "services/core/java/com/android/server/audio/AudioDeviceBroker.java",
        "patchSetId": 13
      },
      "lineNbr": 1615,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-15T12:56:49Z",
      "side": 1,
      "message": "Not from this CL but I think this message and MSG_L_LE_AUDIO_DEVICE_OUT_CONNECTION_CHANGE_EXT should be added to the MESSAGES_MUTE_MUSIC set of messages that cause a temporary mute of music stream when processed",
      "range": {
        "startLine": 1615,
        "startChar": 29,
        "endLine": 1615,
        "endChar": 69
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a3527c4c_747441be",
        "filename": "services/core/java/com/android/server/audio/AudioDeviceBroker.java",
        "patchSetId": 13
      },
      "lineNbr": 1615,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-15T13:41:52Z",
      "side": 1,
      "message": "https://android-review.googlesource.com/c/platform/frameworks/base/+/1859353",
      "parentUuid": "0a76cc98_3944af55",
      "range": {
        "startLine": 1615,
        "startChar": 29,
        "endLine": 1615,
        "endChar": 69
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "38946adb_70908b6a",
        "filename": "services/core/java/com/android/server/audio/AudioDeviceInventory.java",
        "patchSetId": 13
      },
      "lineNbr": 905,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-15T12:56:49Z",
      "side": 1,
      "message": "\u003e Lines longer than 100 characters should be wrapped to improve readability; see https://source.android.com/setup/contribute/code-style#limit-line-length for more details.\n\nPlease fix.",
      "parentUuid": "5391e4f7_f8b3ecb7",
      "range": {
        "startLine": 905,
        "startChar": 0,
        "endLine": 905,
        "endChar": 103
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "070a1922_a9a9b96e",
        "filename": "services/core/java/com/android/server/audio/AudioDeviceInventory.java",
        "patchSetId": 13
      },
      "lineNbr": 905,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-15T13:41:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "38946adb_70908b6a",
      "range": {
        "startLine": 905,
        "startChar": 0,
        "endLine": 905,
        "endChar": 103
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d2a13eea_d04ebad0",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 2956,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-15T12:56:49Z",
      "side": 1,
      "message": "missing call to if (streamType \u003d\u003d getBluetoothContextualVolumeStream())",
      "range": {
        "startLine": 2956,
        "startChar": 0,
        "endLine": 2956,
        "endChar": 32
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c3713fda_5aebb5e2",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 2956,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-15T13:41:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "d2a13eea_d04ebad0",
      "range": {
        "startLine": 2956,
        "startChar": 0,
        "endLine": 2956,
        "endChar": 32
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a67dfe41_73b0bb23",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 2960,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-18T08:08:04Z",
      "side": 1,
      "message": "you can pass the max index here for use in BtHelper.setLeAudioVolume():\n\nmStreamStates[streamType].getMaxIndex()",
      "range": {
        "startLine": 2960,
        "startChar": 0,
        "endLine": 2960,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "14119a73_85a24820",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 2960,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-18T09:28:50Z",
      "side": 1,
      "message": "I like it, but that would required some more changes in order to create message with 3 arguments. \"(mBrokerHandler.obtainMessage(msg, arg1, arg2, arg3, obj).\nBasically it requires changes also in os/Handler.java.\n\nDo you want me to proceed this way or maybe expose some other function for BtHelper to use by btHelper?",
      "parentUuid": "a67dfe41_73b0bb23",
      "range": {
        "startLine": 2960,
        "startChar": 0,
        "endLine": 2960,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9faec1db_109e677b",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 2960,
      "author": {
        "id": 1087037
      },
      "writtenOn": "2021-10-18T09:31:07Z",
      "side": 1,
      "message": "how about just computing the volume value here ?",
      "parentUuid": "14119a73_85a24820",
      "range": {
        "startLine": 2960,
        "startChar": 0,
        "endLine": 2960,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb60b0fd_b7e878f1",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 2960,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-18T09:38:00Z",
      "side": 1,
      "message": "What we do in this case it to use the msg obj argument and create a specific data struct for this message:\nFor instance BtDeviceConnectionInfo for msg MSG_SET_A2DP_DEV_CONNECTION_STATE\nHere it would be \n\nstatic final class BleVolumeInfo {\n        final int mIndex;\n        final int mIndexMax;\n        final int mSgreamType;\n}",
      "parentUuid": "14119a73_85a24820",
      "range": {
        "startLine": 2960,
        "startChar": 0,
        "endLine": 2960,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "698363c7_6511fcd6",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 2960,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-18T10:40:08Z",
      "side": 1,
      "message": "That should work. Thanks.",
      "parentUuid": "bb60b0fd_b7e878f1",
      "range": {
        "startLine": 2960,
        "startChar": 0,
        "endLine": 2960,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c178305d_07df504e",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 3591,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-15T12:56:49Z",
      "side": 1,
      "message": "missing \n \u0026\u0026 streamType \u003d\u003d getBluetoothContextualVolumeStream()",
      "range": {
        "startLine": 3591,
        "startChar": 0,
        "endLine": 3591,
        "endChar": 63
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "12c03a3f_9055b8f6",
        "filename": "services/core/java/com/android/server/audio/AudioService.java",
        "patchSetId": 13
      },
      "lineNbr": 3591,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-15T13:41:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "c178305d_07df504e",
      "range": {
        "startLine": 3591,
        "startChar": 0,
        "endLine": 3591,
        "endChar": 63
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5da78c7f_7f5f6166",
        "filename": "services/core/java/com/android/server/audio/BtHelper.java",
        "patchSetId": 13
      },
      "lineNbr": 407,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-15T12:56:49Z",
      "side": 1,
      "message": "index is in the range 0 to 100. It must be rescaled before sending to BLe profile",
      "range": {
        "startLine": 407,
        "startChar": 0,
        "endLine": 407,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b065f377_8e22f218",
        "filename": "services/core/java/com/android/server/audio/BtHelper.java",
        "patchSetId": 13
      },
      "lineNbr": 407,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-15T13:41:52Z",
      "side": 1,
      "message": "When I tested it on Pixel 4 it was 0-250.",
      "parentUuid": "5da78c7f_7f5f6166",
      "range": {
        "startLine": 407,
        "startChar": 0,
        "endLine": 407,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d8b3d02a_f555c74d",
        "filename": "services/core/java/com/android/server/audio/BtHelper.java",
        "patchSetId": 13
      },
      "lineNbr": 407,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-15T15:04:18Z",
      "side": 1,
      "message": "my bad, it is 10 x max media volume index which is 25 but can be set by a property.\nI think Audioservice should also pass the max volume index and re scaling to whatever range is expected by LE should happen here.\ndon;t forget that this is not always media volume but can also be call volume in which case the range is from 0 to 7",
      "parentUuid": "b065f377_8e22f218",
      "range": {
        "startLine": 407,
        "startChar": 0,
        "endLine": 407,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7a32a298_24e7fe19",
        "filename": "services/core/java/com/android/server/audio/BtHelper.java",
        "patchSetId": 13
      },
      "lineNbr": 407,
      "author": {
        "id": 1087037
      },
      "writtenOn": "2021-10-15T15:07:53Z",
      "side": 1,
      "message": "So to scale, we would need something like for hearing aids:\n\n        //hearing aid expect volume value in range -128dB to 0dB\n        int gainDB \u003d (int) AudioSystem.getStreamVolumeDB(streamType, index / 10,\n                AudioSystem.DEVICE_OUT_HEARING_AID);\n        if (gainDB \u003c BT_HEARING_AID_GAIN_MIN) {\n            gainDB \u003d BT_HEARING_AID_GAIN_MIN;\n        }\n        \n        \n        But for LE Audio",
      "parentUuid": "d8b3d02a_f555c74d",
      "range": {
        "startLine": 407,
        "startChar": 0,
        "endLine": 407,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "42d24e56_8fde351f",
        "filename": "services/core/java/com/android/server/audio/BtHelper.java",
        "patchSetId": 13
      },
      "lineNbr": 407,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-15T15:26:32Z",
      "side": 1,
      "message": "similar but hearing aid volume is in dB whereas LE volume does not seem to be in dB (do you confirm?)\nIn which case a simple rescaling like this is enouhg:\n\nleVolume \u003d index / maxIndex * (BT_LE_AUDIO_MAX_VOL - BT_LE_AUDIO_MIN_VOL) + BT_LE_AUDIO_MIN_VOL",
      "parentUuid": "7a32a298_24e7fe19",
      "range": {
        "startLine": 407,
        "startChar": 0,
        "endLine": 407,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2759db97_c3890fb6",
        "filename": "services/core/java/com/android/server/audio/BtHelper.java",
        "patchSetId": 13
      },
      "lineNbr": 407,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-15T23:22:03Z",
      "side": 1,
      "message": "yes, leAudio volume is not db. It is just 0x00-0xff\n\nErik, where can I get this maxIndex? I see from the comment above that this is 25, but I don\u0027t think I want to use fix value here.",
      "parentUuid": "42d24e56_8fde351f",
      "range": {
        "startLine": 407,
        "startChar": 0,
        "endLine": 407,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9094b7bd_fcf0b9da",
        "filename": "services/core/java/com/android/server/audio/BtHelper.java",
        "patchSetId": 13
      },
      "lineNbr": 407,
      "author": {
        "id": 1087037
      },
      "writtenOn": "2021-10-16T10:48:21Z",
      "side": 1,
      "message": "Max volume changes with stream types. getStreamMaxVolume should return it.\nYou will have to somehow expose it to BtHelpr, maybe as a static method in AudioSystem ?\n\nhttps://cs.android.com/search?q\u003dgetStreamMaxVolume\u0026ss\u003dandroid%2Fplatform%2Fsuperproject:frameworks%2Fbase%2Fmedia%2Fjava%2Fandroid%2Fmedia%2F",
      "parentUuid": "2759db97_c3890fb6",
      "range": {
        "startLine": 407,
        "startChar": 0,
        "endLine": 407,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "214d1dde_b2f23ccf",
        "filename": "services/core/java/com/android/server/audio/BtHelper.java",
        "patchSetId": 13
      },
      "lineNbr": 407,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-18T10:40:08Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "9094b7bd_fcf0b9da",
      "range": {
        "startLine": 407,
        "startChar": 0,
        "endLine": 407,
        "endChar": 78
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e11d4b2f_1e9dc801",
        "filename": "services/core/java/com/android/server/media/BluetoothRouteProvider.java",
        "patchSetId": 13
      },
      "lineNbr": 380,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-10-15T12:56:49Z",
      "side": 1,
      "message": "This log is redundant and should be removed",
      "range": {
        "startLine": 380,
        "startChar": 0,
        "endLine": 380,
        "endChar": 76
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b054b910_0752a8bc",
        "filename": "services/core/java/com/android/server/media/BluetoothRouteProvider.java",
        "patchSetId": 13
      },
      "lineNbr": 380,
      "author": {
        "id": 1085519
      },
      "writtenOn": "2021-10-15T13:41:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "e11d4b2f_1e9dc801",
      "range": {
        "startLine": 380,
        "startChar": 0,
        "endLine": 380,
        "endChar": 76
      },
      "revId": "4c11c4d1b7b2a33f2c5247d902de841db5195f08",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}