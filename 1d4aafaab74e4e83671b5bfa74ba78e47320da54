{
  "comments": [
    {
      "key": {
        "uuid": "a14a674d_d69dacdd",
        "filename": "services/core/jni/com_android_server_am_Cgroups.cpp",
        "patchSetId": 2
      },
      "lineNbr": 30,
      "author": {
        "id": 1157738
      },
      "writtenOn": "2020-01-28T18:47:47Z",
      "side": 1,
      "message": "Things changed since 2018 and now we have cgroup abstraction layer, so instead of hardcoding cgroup paths we use task profiles. In should be possible to express this task migration in terms of task profiles (see: https://android.googlesource.com/platform/system/core/+/master/libprocessgroup/profiles/task_profiles.json). Smth like this:\n\n\n\n    {\n      \"Name\": \"IsolatedCPUProcess\",\n      \"Actions\": [\n        {\n          \"Name\": \"JoinCgroup\",\n          \"Params\":\n          {\n            \"Controller\": \"cpu\",\n            \"Path\": \"apps/uid_\u003cuid\u003e\"\n          }\n        }\n      ]\n    },\n    {\n      \"Name\": \"SharedCPUProcess\",\n      \"Actions\": [\n        {\n          \"Name\": \"JoinCgroup\",\n          \"Params\":\n          {\n            \"Controller\": \"cpu\",\n            \"Path\": \"\"\n          }\n        }\n      ]\n    },\n\nThen you call SetProcessProfiles() to apply the profile.\n\nsee docs here: https://source.android.com/devices/tech/perf/cgroups",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 33
      },
      "revId": "1d4aafaab74e4e83671b5bfa74ba78e47320da54",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3c287b1b_b015e719",
        "filename": "services/core/jni/com_android_server_am_Cgroups.cpp",
        "patchSetId": 2
      },
      "lineNbr": 30,
      "author": {
        "id": 1041495
      },
      "writtenOn": "2020-01-30T15:27:44Z",
      "side": 1,
      "message": "I\u0027m not familiar with task profiles. I\u0027ll take a look and see if I can make it work.",
      "parentUuid": "a14a674d_d69dacdd",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 33
      },
      "revId": "1d4aafaab74e4e83671b5bfa74ba78e47320da54",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "26682814_508362a5",
        "filename": "services/core/jni/com_android_server_am_Cgroups.cpp",
        "patchSetId": 2
      },
      "lineNbr": 56,
      "author": {
        "id": 1105075
      },
      "writtenOn": "2020-01-28T17:40:38Z",
      "side": 1,
      "message": "TEMP_FAILURE_RETRY wrap? or just use WriteStringToFile https://cs.android.com/android/platform/superproject/+/android-9.0.0_r8:system/core/base/include/android-base/file.h;bpv\u003d1;bpt\u003d1;l\u003d40",
      "range": {
        "startLine": 39,
        "startChar": 0,
        "endLine": 56,
        "endChar": 0
      },
      "revId": "1d4aafaab74e4e83671b5bfa74ba78e47320da54",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9d7497eb_a0796ef0",
        "filename": "services/core/jni/com_android_server_am_Cgroups.cpp",
        "patchSetId": 2
      },
      "lineNbr": 73,
      "author": {
        "id": 1157738
      },
      "writtenOn": "2020-01-28T18:47:47Z",
      "side": 1,
      "message": "IMO this fits in libprocessgroup library and can be exposed via existing Process JNI class (see https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/os/Process.java#1145, https://android.googlesource.com/platform/frameworks/base/+/master/core/jni/android_util_Process.cpp#1229, https://android.googlesource.com/platform/system/core/+/master/libprocessgroup/processgroup.cpp#370 for example of how killProcessGroup is implemented and exposed via JNI).",
      "range": {
        "startLine": 57,
        "startChar": 0,
        "endLine": 73,
        "endChar": 1
      },
      "revId": "1d4aafaab74e4e83671b5bfa74ba78e47320da54",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "47a11254_df85ae99",
        "filename": "services/core/jni/com_android_server_am_Cgroups.cpp",
        "patchSetId": 2
      },
      "lineNbr": 73,
      "author": {
        "id": 1041495
      },
      "writtenOn": "2020-01-30T15:27:44Z",
      "side": 1,
      "message": "Makes sense, will do.",
      "parentUuid": "9d7497eb_a0796ef0",
      "range": {
        "startLine": 57,
        "startChar": 0,
        "endLine": 73,
        "endChar": 1
      },
      "revId": "1d4aafaab74e4e83671b5bfa74ba78e47320da54",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}