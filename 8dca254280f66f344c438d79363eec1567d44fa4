{
  "comments": [
    {
      "key": {
        "uuid": "616b2c2f_faef9e58",
        "filename": "core/java/android/provider/Settings.java",
        "patchSetId": 1
      },
      "lineNbr": 10478,
      "author": {
        "id": 1103203
      },
      "writtenOn": "2019-03-04T12:35:07Z",
      "side": 1,
      "message": "conciseness nit for here and below: consider changing\n\n   \"greater or equal than\" -\u003e \"{@code \u003e\u003d}\"\n   \"0 or less than 0\" -\u003e \"{@code \u003c\u003d 0}\"\n   \"larger than 0\" -\u003e \"{@code \u003e 0}\"\n\n? Up to you.",
      "range": {
        "startLine": 10478,
        "startChar": 80,
        "endLine": 10478,
        "endChar": 96
      },
      "revId": "8dca254280f66f344c438d79363eec1567d44fa4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4955a894_36938079",
        "filename": "core/java/android/provider/Settings.java",
        "patchSetId": 1
      },
      "lineNbr": 10513,
      "author": {
        "id": 1103203
      },
      "writtenOn": "2019-03-04T12:35:07Z",
      "side": 1,
      "message": "DATA_STALL_EVALUATION_TYPE_* is private. Either it needs to have the same visibility as this API here, or we can\u0027t refer to it from this documentation. Also, there are multiple files called \"NetworkMonitor.java\". You\u0027d need to say {@link com.android.server.connectivity.NetworkMonitor} in order to be precise.\n\nAlso, \"is calculated from\" is super vague. If I understand correctly what you meant with the previous version of this documentation then what you\u0027re saying is that to use the detection signal DATA_STALL_EVALUATION_TYPE_DNS, once should set the bit at the *index* DATA_STALL_EVALUATION_TYPE_DNS to 1, ie.:\n\n 1 \u003c\u003c DATA_STALL_EVALUATION_TYPE_DNS\n\n? I don\u0027t see how that makes sense:\n  1.) If DATA_STALL_EVALUATION_TYPE_DNS was an _index_, then why are we starting the numbering at 1 rather than 0? It seems to make more sense to define future DATA_STALL_EVALUATION_TYPE_* values to directly be a power of 2, rather than the index / exponent.\n(I also don\u0027t understand the semantics of DEFAULT_DATA_STALL_EVALUATION_TYPES).\n\n  2.) Since there\u0027s only a single constant defined right now, there\u0027s nothing stopping you from defining the DEFAULT_DATA_STALL_EVALUATION_TYPE_* to be the bitmask / power of two.\n\nIf you did that, then this documentation could just become something like:\n\nThis is a bitmask constructed by bitwise-or-ing (ie. {@code |}) the DATA_STALL_EVALUATION_TYPE_* values from {@link com.android.server.connectivity.NetworkMonitor}.",
      "range": {
        "startLine": 10513,
        "startChar": 67,
        "endLine": 10513,
        "endChar": 86
      },
      "revId": "8dca254280f66f344c438d79363eec1567d44fa4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "57e46fb3_81c03e3d",
        "filename": "packages/NetworkStack/src/com/android/server/connectivity/NetworkMonitor.java",
        "patchSetId": 1
      },
      "lineNbr": 131,
      "author": {
        "id": 1103203
      },
      "writtenOn": "2019-03-04T12:35:07Z",
      "side": 1,
      "message": "Changing this constant to public isn\u0027t enough, because the entire class is @hide.\n\nYou also shouldn\u0027t make the class part of the API just because you want to use this one constant. Perhaps this constant should move to a different class that is already part of the API?",
      "range": {
        "startLine": 131,
        "startChar": 4,
        "endLine": 131,
        "endChar": 10
      },
      "revId": "8dca254280f66f344c438d79363eec1567d44fa4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "46d281c2_7bdbf20a",
        "filename": "packages/NetworkStack/src/com/android/server/connectivity/NetworkMonitor.java",
        "patchSetId": 1
      },
      "lineNbr": 131,
      "author": {
        "id": 1304263
      },
      "writtenOn": "2019-03-04T13:16:12Z",
      "side": 1,
      "message": "Sorry that I do not fully understand the scope of API review here. \nI am a little confused combining with comment in Settings.java, The definition in Settings is also @hide. Looks that the visibility is different as this API here. May I know that we need the constant here to be public and not @hide here is caused by DATA_STALL_EVALUATION_TYPE is marked as systemapi in Settings.java?",
      "parentUuid": "57e46fb3_81c03e3d",
      "range": {
        "startLine": 131,
        "startChar": 4,
        "endLine": 131,
        "endChar": 10
      },
      "revId": "8dca254280f66f344c438d79363eec1567d44fa4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "40993b1a_ba8777d1",
        "filename": "packages/NetworkStack/src/com/android/server/connectivity/NetworkMonitor.java",
        "patchSetId": 1
      },
      "lineNbr": 131,
      "author": {
        "id": 1103203
      },
      "writtenOn": "2019-03-04T14:36:58Z",
      "side": 1,
      "message": "The API visibility rules are indeed confusing. They are:\n\n(1.) For public API, everything is public by default unless annotated @hide\n(2.) For other APIs (test, system, CorePlatformApi, ...), everything is private unless annotated @TestApi, @SystemApi, @CorePlatformApi etc.\n\nI think someone was working on making (1.) opt-in rather than opt-out, I don\u0027t know the status.\n\nFor the specific issue here, the stuff in Settings is annotated @SystemApi @TestApi, so it\u0027s part of that APIs, but this field here is not, so it is not part of those APIs. Therefore you need to either (a) make the field part of @SystemApi @TestApi, or (b) not refer to it from javadoc for @SystemApi @TestApi fields. In case of (a), you\u0027d need to move the field out of this class NetworkMonitor because NetworkMonitor as a whole is not part of those APIs and shouldn\u0027t become part of those APIs just because of some field.\n\nIn this particular case, the class NetworkMonitor is private as a whole, so you should not add any of its members to @SystemApi @TestApi.\n\n\nHow to fix this: I don\u0027t know which of the following are feasible, but, if feasible, the following is what think are the options ranked from most desirable to least desirable:\n(1.) Don\u0027t make DATA_STALL_EVALUATION_TYPE part of any API, so you don\u0027t need to make DATA_STALL_EVALUATION_TYPE_DNS part of that API.\n(2.) If that\u0027s not possible, then consider if DATA_STALL_EVALUATION_TYPE can be useful without needing to know about / refer to DATA_STALL_EVALUATION_TYPE_DNS. If yes, then drop the reference in the javadoc.\n(3.) Else, move DATA_STALL_EVALUATION_TYPE_DNS to some other class and make it part of @SystemApi @TestApi",
      "parentUuid": "46d281c2_7bdbf20a",
      "range": {
        "startLine": 131,
        "startChar": 4,
        "endLine": 131,
        "endChar": 10
      },
      "revId": "8dca254280f66f344c438d79363eec1567d44fa4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}