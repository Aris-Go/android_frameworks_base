{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "91870508_d0cba4bb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 24
      },
      "lineNbr": 0,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2021-05-20T14:57:20Z",
      "side": 1,
      "message": "LGTM assuming comments addressed.",
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "308b71aa_3a85cd00",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 24
      },
      "lineNbr": 0,
      "author": {
        "id": 1013508
      },
      "writtenOn": "2021-05-21T00:05:10Z",
      "side": 1,
      "message": "lorenzo@ pinged me to glance at this CL, so I left a few thoughts inline, but it\u0027s been a long time since I worked in this area, so please don\u0027t consider my feedback as blocking merging of this CL if you already have approvals from the current OWNERS of this area.  ðŸ˜Š",
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c0e894d9_4e5ca535",
        "filename": "core/java/android/net/NetworkTemplate.java",
        "patchSetId": 24
      },
      "lineNbr": 517,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2021-05-20T14:57:20Z",
      "side": 1,
      "message": "Boolean accessors usually use \"is\" or \"has\". Suggest calling this \"isMetered\".",
      "range": {
        "startLine": 517,
        "startChar": 15,
        "endLine": 517,
        "endChar": 29
      },
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "631cad69_80f66dc4",
        "filename": "core/java/android/net/NetworkTemplate.java",
        "patchSetId": 24
      },
      "lineNbr": 517,
      "author": {
        "id": 1368080
      },
      "writtenOn": "2021-05-21T05:53:35Z",
      "side": 1,
      "message": "The possible value is METERED_ALL, METERED_YES, METERED_NO.\nIt is not the boolean. Thus I keep the current naming.",
      "parentUuid": "c0e894d9_4e5ca535",
      "range": {
        "startLine": 517,
        "startChar": 15,
        "endLine": 517,
        "endChar": 29
      },
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "218271a6_a76c7c68",
        "filename": "services/core/java/com/android/server/net/NetworkPolicyManagerService.java",
        "patchSetId": 24
      },
      "lineNbr": 1518,
      "author": {
        "id": 1013508
      },
      "writtenOn": "2021-05-21T00:05:10Z",
      "side": 1,
      "message": "Longer-term I was hoping that we could converge these internals towards the well-defined constants on NetworkCapabilities, such as being able to replace NetworkTemplate with something closer to a Predicate\u003cNetworkCapabilities\u003e.\n\nThen we could write matching rules in terms of TRANSPORT_CELLULAR, NET_CAPABILITY_NOT_METERED, etc.\n\n(Pretty much all of this code pre-dates the NetworkCapabilities object, which is why it had its own definitions.)\n\nGoing that direction would let an external caller write their warning/limit code in terms of NetworkCapabilities values would hopefully make it less error-prone over time, and it would automatically pave the way to support all newer transport/capabilities added over there.",
      "range": {
        "startLine": 1518,
        "startChar": 25,
        "endLine": 1518,
        "endChar": 38
      },
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "380ccbdf_bb826c4a",
        "filename": "services/core/java/com/android/server/net/NetworkPolicyManagerService.java",
        "patchSetId": 24
      },
      "lineNbr": 1518,
      "author": {
        "id": 1368080
      },
      "writtenOn": "2021-05-21T05:54:29Z",
      "side": 1,
      "message": "+ junyulai@ to know the suggestion for longer-term plan",
      "parentUuid": "218271a6_a76c7c68",
      "range": {
        "startLine": 1518,
        "startChar": 25,
        "endLine": 1518,
        "endChar": 38
      },
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "da5df230_67e9e2dd",
        "filename": "services/core/java/com/android/server/net/NetworkPolicyManagerService.java",
        "patchSetId": 24
      },
      "lineNbr": 2657,
      "author": {
        "id": 1013508
      },
      "writtenOn": "2021-05-21T00:05:10Z",
      "side": 1,
      "message": "Hmm, the two possible values here appear to be:\n\n    public static final int SUBSCRIBER_ID_MATCH_RULE_EXACT \u003d 0;\n    public static final int SUBSCRIBER_ID_MATCH_RULE_ALL \u003d 1;\n\nWhen I consider the code being persisted here, it\u0027s indicating what type of network should be matched for the purposes of alerting the user of data overages, etc.\n\nI currently don\u0027t see a use-case SUBSCRIBER_ID_MATCH_RULE_ALL for being useful in this situation, since it could cause chaos on multi-SIM devices.  ðŸ˜ž\n\nCould you elaborate on why you\u0027d like to persist this?",
      "range": {
        "startLine": 2657,
        "startChar": 0,
        "endLine": 2657,
        "endChar": 61
      },
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d957b25_a0b10e2b",
        "filename": "services/core/java/com/android/server/net/NetworkPolicyManagerService.java",
        "patchSetId": 24
      },
      "lineNbr": 2657,
      "author": {
        "id": 1368080
      },
      "writtenOn": "2021-05-21T05:53:35Z",
      "side": 1,
      "message": "The wifi network includes two types.\n1. Includes subscriberId - carrier merged wifi network\n2. Excludes subscriberId - a generic wifi network.\n\nThat is why we think it needs to persist this value if we plan to support set a policy for wifi network which based on SSID.",
      "parentUuid": "da5df230_67e9e2dd",
      "range": {
        "startLine": 2657,
        "startChar": 0,
        "endLine": 2657,
        "endChar": 61
      },
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5ea4b2b3_1d52761d",
        "filename": "services/core/java/com/android/server/net/NetworkPolicyManagerService.java",
        "patchSetId": 24
      },
      "lineNbr": 2664,
      "author": {
        "id": 1013508
      },
      "writtenOn": "2021-05-21T00:05:10Z",
      "side": 1,
      "message": "Hm, this is similar to above; I\u0027m not seeing the use-case where a network alerting rule would need to write a rule which makes a meteredness distinction; they\u0027re typically always implemented against a metered connection, right?",
      "range": {
        "startLine": 2662,
        "startChar": 0,
        "endLine": 2664,
        "endChar": 0
      },
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0e69736a_ba8801dc",
        "filename": "services/core/java/com/android/server/net/NetworkPolicyManagerService.java",
        "patchSetId": 24
      },
      "lineNbr": 2664,
      "author": {
        "id": 1368080
      },
      "writtenOn": "2021-05-21T05:53:35Z",
      "side": 1,
      "message": "The major reason is we plan to remove a hard code metered check in matchesMobile.\nsee: The discrepancy between matchesCarrier and matchesMobile\nmatchesMobile:\nhttps://source.corp.google.com/aosp-master/frameworks/base/core/java/android/net/NetworkTemplate.java;l\u003d610?q\u003dcore%2Fjava%2Fandroid%2Fnet%2FNetworkTemplate.java\u0026start\u003d11\nmatchesCarrier: \nhttps://source.corp.google.com/aosp-master/frameworks/base/core/java/android/net/NetworkTemplate.java;l\u003d715?q\u003dcore%2Fjava%2Fandroid%2Fnet%2FNetworkTemplate.java\u0026start\u003d11\n\nNow we use buildTemplateCarrierMetered which use METERED_YES to force metered network in NetworkTemplate.\n\nThus we need to persist the meteredness value in template. Otherwise it will cause multi-policy and caller update incorrect policy after reboot devices.",
      "parentUuid": "5ea4b2b3_1d52761d",
      "range": {
        "startLine": 2662,
        "startChar": 0,
        "endLine": 2664,
        "endChar": 0
      },
      "revId": "91261e551cd2a3eb637b82b7d91451fe50c6fe7d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}