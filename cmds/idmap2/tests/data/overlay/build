FRAMEWORK_RES_APK="$(gettop)/out/target/common/obj/APPS/framework-res_intermediates/package-export.apk"

aapt2 compile --dir res-strings -o res-strings.flata
aapt2 compile --dir res-integers -o res-integers.flata

aapt2 link \
    --no-resource-removal \
    -I "$FRAMEWORK_RES_APK" \
    --manifest AndroidManifestNoCategory.xml \
    -o overlay-no-category.apk \
    res-strings.flata res-integers.flata

aapt2 link \
    --no-resource-removal \
    -I "$FRAMEWORK_RES_APK" \
    --manifest AndroidManifestCategoryStrings.xml \
    -o overlay-category-strings.apk \
    res-strings.flata

aapt2 link \
    --no-resource-removal \
    -I "$FRAMEWORK_RES_APK" \
    --manifest AndroidManifestCategoryIntegers.xml \
    -o overlay-category-integers.apk \
    res-integers.flata

aapt2 link \
    --no-resource-removal \
    -I "$FRAMEWORK_RES_APK" \
    --manifest AndroidManifestCategoryStrings.xml \
    -o overlay-category-strings-also-includes-res-integers.apk \
    res-strings.flata res-integers.flata

aapt2 link \
    --no-resource-removal \
    -I "$FRAMEWORK_RES_APK" \
    --manifest AndroidManifestStatic1.xml \
    -o overlay-static-1.apk \
    res-strings.flata

aapt2 link \
    --no-resource-removal \
    -I "$FRAMEWORK_RES_APK" \
    --manifest AndroidManifestStatic2.xml \
    -o overlay-static-2.apk \
    res-strings.flata

rm res-{integers,strings}.flata
