{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a6f33784_d8f07b74",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2020-11-27T01:00:12Z",
      "side": 1,
      "message": "LGTM assuming it\u0027s guaranteed that ConnectivityManager is available when the Vpn constructor is called. See inline comment.",
      "revId": "7f64d14fe353adb75f3bd85567fb780adfc99f39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3444e62e_20079801",
        "filename": "services/core/java/com/android/server/connectivity/Vpn.java",
        "patchSetId": 1
      },
      "lineNbr": 382,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2020-11-27T01:00:12Z",
      "side": 1,
      "message": "Is it guaranteed that this will return non-null if this code is called very early on boot? Specifically I think this code can be called in the USER_STARTED broadcast. Currently, for that to happen the ConnectivityService handler thread must be started. Maybe that\u0027s late enough to guarantee that ConnectivityManager is available.",
      "range": {
        "startLine": 382,
        "startChar": 31,
        "endLine": 382,
        "endChar": 84
      },
      "revId": "7f64d14fe353adb75f3bd85567fb780adfc99f39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0874cca8_c2340e38",
        "filename": "services/core/java/com/android/server/connectivity/Vpn.java",
        "patchSetId": 1
      },
      "lineNbr": 382,
      "author": {
        "id": 1015428
      },
      "writtenOn": "2020-11-27T05:27:37Z",
      "side": 1,
      "message": "This can never return null (it will throw instead).\nMy reading of the code makes me think this can happen immediately as CS is instantiated, which happens immediately before it\u0027s registered as a service. So I think there is a window of opportunity for this to throw, though I couldn\u0027t repro it by rebooting the device a few times.\n\nChanged into a method.",
      "parentUuid": "3444e62e_20079801",
      "range": {
        "startLine": 382,
        "startChar": 31,
        "endLine": 382,
        "endChar": 84
      },
      "revId": "7f64d14fe353adb75f3bd85567fb780adfc99f39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f724a86f_1f516423",
        "filename": "services/core/java/com/android/server/connectivity/Vpn.java",
        "patchSetId": 1
      },
      "lineNbr": 382,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2020-11-27T09:57:05Z",
      "side": 1,
      "message": "FWIW: it\u0027s possible that this race can never actually happen. So if you want to make this a final member again, and that works, it would be preferable. If it seems to work and then we find out that it crashes sometimes, we can always go back to a method.\n\nLGTM either way.",
      "parentUuid": "0874cca8_c2340e38",
      "range": {
        "startLine": 382,
        "startChar": 31,
        "endLine": 382,
        "endChar": 84
      },
      "revId": "7f64d14fe353adb75f3bd85567fb780adfc99f39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1877a75c_8c408970",
        "filename": "services/core/java/com/android/server/connectivity/Vpn.java",
        "patchSetId": 1
      },
      "lineNbr": 382,
      "author": {
        "id": 1015428
      },
      "writtenOn": "2020-11-30T01:32:19Z",
      "side": 1,
      "message": "Of course I did try to boot a device a couple times and couldn\u0027t produce a crash. But reasoning seems to indicate this is likely to happen occasionally. Also, if it can\u0027t for some obscure reason somewhere, it\u0027s possible this comes back to bite us in a few releases.\n\nBut I think the advantages of having a final member are very large anyway, so let\u0027s keep it and deal with any issue if they do surface.",
      "parentUuid": "f724a86f_1f516423",
      "range": {
        "startLine": 382,
        "startChar": 31,
        "endLine": 382,
        "endChar": 84
      },
      "revId": "7f64d14fe353adb75f3bd85567fb780adfc99f39",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}