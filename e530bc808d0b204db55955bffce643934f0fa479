{
  "comments": [
    {
      "key": {
        "uuid": "16431782_54484944",
        "filename": "libs/hwui/OpenGLRenderer.cpp",
        "patchSetId": 1
      },
      "lineNbr": 2259,
      "author": {
        "id": 1040058
      },
      "writtenOn": "2014-08-06T16:49:59Z",
      "side": 1,
      "message": "Since we are on the change here. \nMaybe adding some more visual comments will be helpful like:\n\nb --- c          \u003c- (v1)\n\n|  ....  |\n\na --- d          \u003c- (v2)\n\n\n^ .... ^\n\n(u1) (u2)",
      "revId": "e530bc808d0b204db55955bffce643934f0fa479",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9681c74e_d85b856b",
        "filename": "libs/hwui/OpenGLRenderer.cpp",
        "patchSetId": 1
      },
      "lineNbr": 2259,
      "author": {
        "id": 1051423
      },
      "writtenOn": "2014-08-15T05:15:10Z",
      "side": 1,
      "message": "Good idea, thanks",
      "parentUuid": "16431782_54484944",
      "revId": "e530bc808d0b204db55955bffce643934f0fa479",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "16431782_94293175",
        "filename": "libs/hwui/OpenGLRenderer.cpp",
        "patchSetId": 1
      },
      "lineNbr": 2274,
      "author": {
        "id": 1040058
      },
      "writtenOn": "2014-08-06T16:49:59Z",
      "side": 1,
      "message": "u , v coordinates are reset for each (x, y) pair, but here, you only update u2 here.\nRemember to run the test //frameworks/base/tests/HwAccelerationTest/src/com/android/test/hwui/BitmapMeshLayerActivity.java to make sure there is no regression. Because this change break that.",
      "revId": "e530bc808d0b204db55955bffce643934f0fa479",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f6712354_7605c1e1",
        "filename": "libs/hwui/OpenGLRenderer.cpp",
        "patchSetId": 1
      },
      "lineNbr": 2274,
      "author": {
        "id": 1051423
      },
      "writtenOn": "2014-08-15T05:15:10Z",
      "side": 1,
      "message": "Hmm... I think Mapping U, V coordinates is all right here.\nMesh are processed row by row. \n(v1)-\u003e  v00 --- v01 --- v02 --- v03          \n         |  ...  |  ...  |  ...  | \n(v2)-\u003e  v10 --- v11 --- v12 --- v13       \n         ^  ...  ^\n        (u1)    (u2)\n\n(u1, v1, u2, v2) coordinates are inited once on the start of row (line 2274, outer loop) because all the vertices of same row have same V (v1 or v2) coordinate (e.g v00.v \u003d\u003d v01.v \u003d\u003d v02.v \u003d\u003d v03.v \u003d\u003d v1). I just need to update U (u2) coordinate in the inner loop (line 2283) because vertices of same column have same U coordinate. (e.g v00.u \u003d\u003d v10.u \u003d\u003d updated u2).\n\nI tested both BitmapMeshActivity.java and BitmapMeshLayerActivity.java. Found that:\n    *Mesh Texture mapping is all right\n    *Color mask of right-top case is incorrect.\n[root-cause]: In canvas drawBitmapMesh API, parameter \"colors\" Specifies a color at each vertex, which is interpolated across the cell, and whose values are multiplied by the corresponding bitmap colors. But the API doesn\u0027t define how the colors should be interpolated. \n\nTake this case for example: The triangle order of original code is \"dab\" \"dbc\", so p\u0027s color is interpolated by vertices d, a and b. But I changed triangle order as \"bac\", \"acd\" for performance. So p\u0027s color would be interpolated by vertices b, a and c.\n    b --- c         \n    |.p   |\n    a --- d\nIt\u0027s hard to say a bug, I\u0027d like to change triangle order to align with original color interpolate behavior.",
      "parentUuid": "16431782_94293175",
      "revId": "e530bc808d0b204db55955bffce643934f0fa479",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}