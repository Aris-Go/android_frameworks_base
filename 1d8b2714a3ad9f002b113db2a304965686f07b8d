{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "99025f8b_14aee78b",
        "filename": "AconfigFlags.bp",
        "patchSetId": 11
      },
      "lineNbr": 160,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-10-13T08:50:48Z",
      "side": 1,
      "message": "should we have a `// Media` heading?\n\ni also notice that the names of the existing targets are all of the form `android.XXX.flags-aconfig(-java)`\n\nmaybe we should have a similar name? e.g. `android.media.playback.flags-aconfig`",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3fb31130_32307f36",
        "filename": "AconfigFlags.bp",
        "patchSetId": 11
      },
      "lineNbr": 160,
      "author": {
        "id": 1546599
      },
      "writtenOn": "2023-10-16T15:02:33Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "99025f8b_14aee78b",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c238bb8a_0382b8e8",
        "filename": "media/tests/MediaFrameworkTest/src/com/android/mediaframeworktest/unit/MediaMetadataRetrieverTest.java",
        "patchSetId": 11
      },
      "lineNbr": 284,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-10-13T08:50:48Z",
      "side": 1,
      "message": "I\u0027ve filed b/305160754 to track that this doesn\u0027t seem to propagate properly to the C++ code.\n\nIn the meantime in order to unblock the CL I suggest we switch (back) to the `CheckFlagsRule` and `@RequiresFlagsEnabled/Disabled` annotations with a `TODO(b/305160754)` to switch to setting the flag manually when the bug is resolved.",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db4a3eaf_7f16a394",
        "filename": "media/tests/MediaFrameworkTest/src/com/android/mediaframeworktest/unit/MediaMetadataRetrieverTest.java",
        "patchSetId": 11
      },
      "lineNbr": 284,
      "author": {
        "id": 1546599
      },
      "writtenOn": "2023-10-14T02:51:51Z",
      "side": 1,
      "message": "Ian,\nIn order to use @RequiresFlagsEnabled/Disabled approach, MediaMetadataRetrieverTest first needs to be migrated to JUnit4.\nI will first migrate the test to JUnit4 (filed b/305324235) and then update this CL.",
      "parentUuid": "c238bb8a_0382b8e8",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "353c1265_110a6811",
        "filename": "media/tests/MediaFrameworkTest/src/com/android/mediaframeworktest/unit/MediaMetadataRetrieverTest.java",
        "patchSetId": 11
      },
      "lineNbr": 284,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-10-16T09:14:10Z",
      "side": 1,
      "message": "Ah cool - thanks for pointing that out, I hadn\u0027t noticed this was JUnit3! \n\nThat might also explain why the `SetFlagsRule` isn\u0027t working properly either? Since rules are a JUnit4 feature too. Can we rebase this on top of the JUnit4 migration and try the `SetFlagsRule` again first just in case? And if it still doesn\u0027t work then switch to `@RequiresFlagEnabled/Disabled`",
      "parentUuid": "db4a3eaf_7f16a394",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f11ad3ed_79ac0c87",
        "filename": "media/tests/MediaFrameworkTest/src/com/android/mediaframeworktest/unit/MediaMetadataRetrieverTest.java",
        "patchSetId": 11
      },
      "lineNbr": 284,
      "author": {
        "id": 1546599
      },
      "writtenOn": "2023-10-16T13:00:51Z",
      "side": 1,
      "message": "Ian,\nYes. That was my thought too and I had tried that on Friday.\nIt seems like the flags that we set in aosp/main, the java flags and native flags aren\u0027t in sync.\nEven when I tried the annotaiton approach, I had to set the flags using both device_config put and setprop approach and only then I was able to get the tests to behave as expected.\nNot sure if aosp/main is missing some commits.\nI will sync to the latest aosp/main and check again and rebase this CL and still keep the SetFlags approach for now in this CL for now.",
      "parentUuid": "353c1265_110a6811",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "925f1af1_e828399b",
        "filename": "media/tests/MediaFrameworkTest/src/com/android/mediaframeworktest/unit/MediaMetadataRetrieverTest.java",
        "patchSetId": 11
      },
      "lineNbr": 284,
      "author": {
        "id": 1546599
      },
      "writtenOn": "2023-10-16T15:02:33Z",
      "side": 1,
      "message": "Rebased the CL, but the test still fails.\nLooks like whatever is being set to java isn\u0027t propagating to native code.",
      "parentUuid": "f11ad3ed_79ac0c87",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e729b293_666528cb",
        "filename": "media/tests/MediaFrameworkTest/src/com/android/mediaframeworktest/unit/MediaMetadataRetrieverTest.java",
        "patchSetId": 11
      },
      "lineNbr": 284,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-10-16T15:13:07Z",
      "side": 1,
      "message": "ack - guess we need to switch to TODO + `@RequiresFlagsEnabled/Disabled` then",
      "parentUuid": "925f1af1_e828399b",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fe6361d8_5a311c02",
        "filename": "media/tests/MediaFrameworkTest/src/com/android/mediaframeworktest/unit/MediaMetadataRetrieverTest.java",
        "patchSetId": 11
      },
      "lineNbr": 284,
      "author": {
        "id": 1546599
      },
      "writtenOn": "2023-10-16T15:58:24Z",
      "side": 1,
      "message": "If the recommended practice is to use @RequiresFlagsEnabled/Disabled in CTS and SetFlagsRule at unit test level, would it be better to leave these tests as they are now and then add separate CTS tests that use @RequiresFlagEnabled/Disabled annotations?\n\nPlease Note: If we change this CL to RequiresFlag annotations, then the bug that is filed to investigate SetFlagsRule not reflecting the flag values at native level will need to be updated to say how to reproduce.\n\nAlso need to check if SetFlagsRule works as intended in git_main and doesn\u0027t work correctly in aosp/main (in case some CLs are missing in aosp/main).",
      "parentUuid": "e729b293_666528cb",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d2650d18_86116fe2",
        "filename": "media/tests/MediaFrameworkTest/src/com/android/mediaframeworktest/unit/MediaMetadataRetrieverTest.java",
        "patchSetId": 11
      },
      "lineNbr": 284,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-10-16T16:01:26Z",
      "side": 1,
      "message": "It\u0027s not appropriate to add a CTS test for this change because we\u0027re changing behavior within the defined API contract (i.e. both the behavior with and without this change are valid behaviors of the API, so CTS shouldn\u0027t enforce one or the other, regardless of flag values).\n\nI think submitting this change with a TODO is fine. If the bug gets picked up and the repro steps are unclear we can clarify with a follow-up CL.\n\n----\n\n\u003e Also need to check if SetFlagsRule works as intended in git_main and doesn\u0027t work correctly in aosp/main (in case some CLs are missing in aosp/main).\n\nYeah this is a good idea - are you able to check this?",
      "parentUuid": "fe6361d8_5a311c02",
      "revId": "1d8b2714a3ad9f002b113db2a304965686f07b8d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}