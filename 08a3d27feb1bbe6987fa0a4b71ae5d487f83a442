{
  "comments": [
    {
      "key": {
        "uuid": "ffad711c_4d1e3115",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 36,
      "author": {
        "id": 1399364
      },
      "writtenOn": "2019-06-12T15:59:36Z",
      "side": 1,
      "message": "Can you also add 129264869?",
      "range": {
        "startLine": 36,
        "startChar": 0,
        "endLine": 36,
        "endChar": 3
      },
      "revId": "08a3d27feb1bbe6987fa0a4b71ae5d487f83a442",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "787626ef_0fc79e3e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 36,
      "author": {
        "id": 1221725
      },
      "writtenOn": "2019-06-12T21:19:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ffad711c_4d1e3115",
      "range": {
        "startLine": 36,
        "startChar": 0,
        "endLine": 36,
        "endChar": 3
      },
      "revId": "08a3d27feb1bbe6987fa0a4b71ae5d487f83a442",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "49f6ce45_1f8da1e4",
        "filename": "services/core/java/com/android/server/ConnectivityService.java",
        "patchSetId": 3
      },
      "lineNbr": 6802,
      "author": {
        "id": 1015428
      },
      "writtenOn": "2019-06-12T14:04:22Z",
      "side": 1,
      "message": "You bet it does, and if I understand this correctly, you have an inversion here, because you\u0027re going to count the traffic *so far* with the *new* vpn info. Example :\n\n• Device only has cellular.\n• VPN is established. Cellular is its underlying network.\n• A gazillion traffic happens.\n• Wifi connects. The VPN sets its new underlying network to wifi.\n• This method is called. The code updates the VPN info to say the VPN is now underlied by Wifi.\n• Now force update interfaces and count the traffic.\n• Turns out, the VPN has done a gazillion traffic on the cellular interface.\n• But cellular does not underly it, so the VPN is blamed for a gazillion traffic.\n\nAm I missing something ? If I\u0027m not, it means we need to write a new test for this case.\n\nOf course in practice it probably wouldn\u0027t matter too much because readNetworkStats is called regularly anyway while underlying interfaces probably don\u0027t change that often, and there are small (few milliseconds) gaps where traffic can go accounted with wrong interfaces anyway. I think at worst that means 2MB are blamed to the wrong place, since for quota we poll at most every 2MB IIRC.\n\nI don\u0027t think your change is introducing this – Varun\u0027s change already had this bug.",
      "range": {
        "startLine": 6802,
        "startChar": 20,
        "endLine": 6802,
        "endChar": 37
      },
      "revId": "08a3d27feb1bbe6987fa0a4b71ae5d487f83a442",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5a966838_5a5f7e28",
        "filename": "services/core/java/com/android/server/ConnectivityService.java",
        "patchSetId": 3
      },
      "lineNbr": 6802,
      "author": {
        "id": 1399364
      },
      "writtenOn": "2019-06-12T15:59:36Z",
      "side": 1,
      "message": "\u003e Am I missing something ? If I\u0027m not, it means we need to write a new test for this case.\n\nThe *gazillion* traffic should theoretically be bounded to 2MB (practically it can be \u003e\u003e 2MB) due to global alert threshold set.\n\n\u003e I don\u0027t think your change is introducing this – Varun\u0027s change already had this bug.\n\nYes, this has been a long existing bug (even before my changes). I have thought about fixing this for a long time. Anyways, I\u0027ve filed b/135113409. I\u0027m thinking maybe we should punt it for R, given that all this accounting is already too complex and too many changes related to this are already been made in Q? WDYT?",
      "parentUuid": "49f6ce45_1f8da1e4",
      "range": {
        "startLine": 6802,
        "startChar": 20,
        "endLine": 6802,
        "endChar": 37
      },
      "revId": "08a3d27feb1bbe6987fa0a4b71ae5d487f83a442",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eaf3e9ce_1e0eee41",
        "filename": "services/core/java/com/android/server/net/NetworkStatsFactory.java",
        "patchSetId": 3
      },
      "lineNbr": 94,
      "author": {
        "id": 1015428
      },
      "writtenOn": "2019-06-12T14:04:22Z",
      "side": 1,
      "message": "Do we want to keep this comment ? We\u0027re going the other way around with this change.",
      "range": {
        "startLine": 94,
        "startChar": 4,
        "endLine": 94,
        "endChar": 72
      },
      "revId": "08a3d27feb1bbe6987fa0a4b71ae5d487f83a442",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fdc76043_e78fc9c7",
        "filename": "services/core/java/com/android/server/net/NetworkStatsFactory.java",
        "patchSetId": 3
      },
      "lineNbr": 94,
      "author": {
        "id": 1399364
      },
      "writtenOn": "2019-06-12T15:59:36Z",
      "side": 1,
      "message": "This is probably necessary for now as some of the 464xlat adj is also performed in NSS (for tether traffic and video telephony traffic). So, its in context to that: http://cs/aosp-master/frameworks/base/services/core/java/com/android/server/net/NetworkStatsService.java?l\u003d1664",
      "parentUuid": "eaf3e9ce_1e0eee41",
      "range": {
        "startLine": 94,
        "startChar": 4,
        "endLine": 94,
        "endChar": 72
      },
      "revId": "08a3d27feb1bbe6987fa0a4b71ae5d487f83a442",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}