{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "4526e116_a3ecfbb3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1729155
      },
      "writtenOn": "2020-11-24T17:40:22Z",
      "side": 1,
      "message": "LGTM from Bluetooth perspective that we need such API to allow non BatteryStats Service log the detailed wakeup reason. ",
      "revId": "d66d04f86676295511b3e1d4558419a37b8476f1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "71d8c353_62c82a03",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1241955
      },
      "writtenOn": "2020-11-25T06:28:11Z",
      "side": 1,
      "message": "Would it be possible to get more information about exactly how this will be used and what the purpose is?\n\nWithout knowing that, it seems like this will corrupt the collection of wakeup data.  BSS already collects data from the kernel for each kernel resume, so if some other entity (e.g. BT) decides to log additional wakeup reasons for those same wakeups, suddenly we\u0027re going to have more wakeup reasons than wakeups, and that\u0027s likely to cause problems with troubleshooting battery issues.\n\n(I presume this is part of BTAA, and I\u0027m excited to see the improvements from that... I\u0027m just curious about all of the follow-on ramifications of this specific change.)",
      "revId": "d66d04f86676295511b3e1d4558419a37b8476f1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a2425b36_cee7957e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1003801
      },
      "writtenOn": "2020-11-30T22:42:44Z",
      "side": 1,
      "message": "@dmitri, ptal?",
      "revId": "d66d04f86676295511b3e1d4558419a37b8476f1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c227f16f_36e2716a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1546552
      },
      "writtenOn": "2020-12-08T00:20:49Z",
      "side": 1,
      "message": "\u003e Would it be possible to get more information about exactly how this will be used and what the purpose is?\n\u003e \n\u003e Without knowing that, it seems like this will corrupt the collection of wakeup data.  BSS already collects data from the kernel for each kernel resume, so if some other entity (e.g. BT) decides to log additional wakeup reasons for those same wakeups, suddenly we\u0027re going to have more wakeup reasons than wakeups, and that\u0027s likely to cause problems with troubleshooting battery issues.\n\u003e \n\u003e (I presume this is part of BTAA, and I\u0027m excited to see the improvements from that... I\u0027m just curious about all of the follow-on ramifications of this specific change.)\n\nYeah absolutely! Our goal is to use this to understand the wakeup reasons a bit better. As part of the power attribution project, we want to be able to note what bluetooth-related reason caused the wakeup and what bluetooth device it corresponded to. Currently, wakeup reasons for bluetooth tend to just be a generic message (e.g. for the qualcomm bluetooth kernel, the wakeup reason is hs_uart_wakeup). We have absolutely no problem with keeping that in place and appending our string of bluetooth activity + device address to the kernel provided wakeup reason. The primary use case will be to analyze bug reports for power-related issues and identify which device is causing higher than normal battery drain.\n\nWe\u0027re not trying to break the 1:1 relationship between a wakeup and the reason, so if you have any guidance on how we could best achieve this, that would be great!",
      "parentUuid": "71d8c353_62c82a03",
      "revId": "d66d04f86676295511b3e1d4558419a37b8476f1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4886ad1a_ba5d7ee8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1241955
      },
      "writtenOn": "2020-12-08T01:11:59Z",
      "side": 1,
      "message": "Off the cuff, an API like appendWakeupDetails() rather than kind of overloading notifyWakeupReason() seems preferable.  But based on the exchange w/ Dmitri, I\u0027m wondering if I misunderstood how this patchset will affect the data.\n\nWould it be possible to get a bugreport where this change and corresponding BT changes are both running and the BatteryStats data shows what the consequences of this CL will actually look like?",
      "parentUuid": "c227f16f_36e2716a",
      "revId": "d66d04f86676295511b3e1d4558419a37b8476f1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c575ae91_87b25a57",
        "filename": "core/java/com/android/internal/app/IBatteryStats.aidl",
        "patchSetId": 2
      },
      "lineNbr": 165,
      "author": {
        "id": 1003473
      },
      "writtenOn": "2020-12-01T00:18:37Z",
      "side": 1,
      "message": "What is the difference between this new method and noteWakeUp(reason)?",
      "range": {
        "startLine": 165,
        "startChar": 9,
        "endLine": 165,
        "endChar": 25
      },
      "revId": "d66d04f86676295511b3e1d4558419a37b8476f1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0745fa42_19e19c00",
        "filename": "core/java/com/android/internal/app/IBatteryStats.aidl",
        "patchSetId": 2
      },
      "lineNbr": 165,
      "author": {
        "id": 1546552
      },
      "writtenOn": "2020-12-03T18:51:15Z",
      "side": 1,
      "message": "My understanding was that noteWakeUp creates a new wakeup entry while noteWakeupReason just overwrites the wakeup reason in an existing entry.",
      "parentUuid": "c575ae91_87b25a57",
      "range": {
        "startLine": 165,
        "startChar": 9,
        "endLine": 165,
        "endChar": 25
      },
      "revId": "d66d04f86676295511b3e1d4558419a37b8476f1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dc1d7497_8d3b4f76",
        "filename": "core/java/com/android/internal/app/IBatteryStats.aidl",
        "patchSetId": 2
      },
      "lineNbr": 165,
      "author": {
        "id": 1003473
      },
      "writtenOn": "2020-12-03T19:57:14Z",
      "side": 1,
      "message": "Do you mean that it overwrites the wakeup reason for the most recent wakeup?  Is there a possibility of a race?",
      "parentUuid": "0745fa42_19e19c00",
      "range": {
        "startLine": 165,
        "startChar": 9,
        "endLine": 165,
        "endChar": 25
      },
      "revId": "d66d04f86676295511b3e1d4558419a37b8476f1",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}