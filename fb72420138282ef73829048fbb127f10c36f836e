{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "bf20ffaf_e9598dee",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1390168
      },
      "writtenOn": "2022-12-02T02:39:16Z",
      "side": 1,
      "message": "Don\u0027t report device state until hardware state is known. \n\nHi @akulian@google.com  , \nThe changes have been readied, please help review, thank you!",
      "revId": "fb72420138282ef73829048fbb127f10c36f836e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "51ebf137_05e89031",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1097438
      },
      "writtenOn": "2022-12-02T03:42:34Z",
      "side": 1,
      "message": "@kennethford@google.com, @jiamingliu@google.com, could you please help provide your reviews?",
      "revId": "fb72420138282ef73829048fbb127f10c36f836e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15771da3_bb3ea5f1",
        "filename": "services/core/java/com/android/server/devicestate/DeviceStateManagerService.java",
        "patchSetId": 2
      },
      "lineNbr": 268,
      "author": {
        "id": 1390168
      },
      "writtenOn": "2022-12-02T06:35:49Z",
      "side": 1,
      "message": "The CL refer to the design of exception throw:\n\n```\nDon\u0027t report device state until hardware state is known.  \n\nThe previous implementation of DeviceStateProviderImpl would report the current device state as soon as a listener was registered leading to a series of device state changes on boot as the state of the hardware becomes known. This changes the implementation to await callbacks before notifying the listener of a change in device state.  \n\nFixes: 181671216 \nTest: atest DeviceStateProviderImplTest\nTest: atest DeviceStateManagerServiceTest\nTest: atest DeviceStateManagerGlobalTest \nChange-Id: I3f133b6d7135b829b79c9f225ae52c71061faa3e\n```",
      "range": {
        "startLine": 265,
        "startChar": 0,
        "endLine": 268,
        "endChar": 9
      },
      "revId": "fb72420138282ef73829048fbb127f10c36f836e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e370b30_16e9e4bb",
        "filename": "services/core/java/com/android/server/devicestate/DeviceStateManagerService.java",
        "patchSetId": 2
      },
      "lineNbr": 493,
      "author": {
        "id": 1972759
      },
      "writtenOn": "2022-12-02T07:11:43Z",
      "side": 1,
      "message": "I think it is safer if we add a check to notifyDeviceStateInfoChangedAsync() like this:\n\nif (!mBaseState.isPresent() || !mCommittedState.isPresent()) {\n  Slog.e(TAG, \"Cannot notify device state info change before the initial state has been committed.\");\n  return;\n}\n\nLet\u0027s wait for Kenneth to comment on this since he\u0027s more familiar with the code.",
      "revId": "fb72420138282ef73829048fbb127f10c36f836e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c48ce6db_e1315071",
        "filename": "services/core/java/com/android/server/devicestate/DeviceStateManagerService.java",
        "patchSetId": 2
      },
      "lineNbr": 493,
      "author": {
        "id": 1390168
      },
      "writtenOn": "2022-12-02T13:25:02Z",
      "side": 1,
      "message": "This modification will not be thrown again, \nbut the mActiveOverride member needs to be considered additionally.\n```\n// need to be notify\nmBaseState.isPresent() \u0026\u0026 !mActiveOverride.isPresent()\n```",
      "parentUuid": "9e370b30_16e9e4bb",
      "revId": "fb72420138282ef73829048fbb127f10c36f836e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}