{
  "comments": [
    {
      "key": {
        "uuid": "a7253ed3_9e97eab4",
        "filename": "data/fonts/Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 38,
      "author": {
        "id": 1074628
      },
      "writtenOn": "2020-05-26T17:24:58Z",
      "side": 1,
      "message": "Ideally, if we need to do this, we do it as a real module, not as a side-effect of a phony package:\n\n  include $$(CLEAR_VARS)\n  LOCAL_MODULE :\u003d $(1)\n  LOCAL_MODULE_CLASS :\u003d ETC\n  LOCAL_MODULE_PATH :\u003d $(PRODUCT_OUT)/system/fonts/$(1)\n  LOCAL_REQUIRED_MODULES :\u003d $(2)\n  include $$(BUILD_SYSTEM)/base_rules.mk\n  $$(call symlink-file,,$(2),$$(LOCAL_BUILT_MODULE))\n\nBut that doesn\u0027t work today, since the built -\u003e install copy doesn\u0027t preserve symlinks (it\u0027s not using `cp -P`). Maybe if we fix that for the install action, that\u0027ll make things work better? (We don\u0027t want to do that for all copies, since reads from the source tree should be dereferencing still)",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 38,
        "endChar": 78
      },
      "revId": "9bbb130bb55dfb1de00d6c9d8d30ceb6c4c47336",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ce948988_7584c893",
        "filename": "data/fonts/Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 38,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2020-05-26T18:38:13Z",
      "side": 1,
      "message": "I guess this built-\u003einstall not working is the reason why we have the original weird hack.\n\nHow about using LOCAL_POST_INSTALL_CMD to force create the installed symlink? Still hacky but at least we don\u0027t need to change base_rules.mk\u0027s install command",
      "parentUuid": "a7253ed3_9e97eab4",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 38,
        "endChar": 78
      },
      "revId": "9bbb130bb55dfb1de00d6c9d8d30ceb6c4c47336",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "15aea71e_dbd17ce6",
        "filename": "data/fonts/Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 38,
      "author": {
        "id": 1074628
      },
      "writtenOn": "2020-05-26T19:00:23Z",
      "side": 1,
      "message": "This hack went back quite a ways to when make (and later, ninja) didn\u0027t properly support symlinks (though ones of this style usually didn\u0027t cause issues).\n\nUsing LOCAL_POST_INSTALL_CMDS would be a regression to what we\u0027re trying to do here -- to actually define this module in our various build graphs.\n\nWe could fixup the install cp rule to support installing symlinks, but the right thing to do here may be to implement the `symlinks`(-\u003e LOCAL_MODULE_SYMLINKS) property support in `prebuilt_font`, and just move these two definitions into the Roboto-(Regular|Bold).ttf modules.",
      "parentUuid": "ce948988_7584c893",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 38,
        "endChar": 78
      },
      "revId": "9bbb130bb55dfb1de00d6c9d8d30ceb6c4c47336",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f8f86b9e_9fc3e75d",
        "filename": "data/fonts/Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 38,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2020-05-27T09:10:46Z",
      "side": 1,
      "message": "SG, filed b/157537895 for this",
      "parentUuid": "15aea71e_dbd17ce6",
      "range": {
        "startLine": 23,
        "startChar": 0,
        "endLine": 38,
        "endChar": 78
      },
      "revId": "9bbb130bb55dfb1de00d6c9d8d30ceb6c4c47336",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}