{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4da2f6df_b54e89a6",
        "filename": "core/java/android/os/storage/StorageArea.java",
        "patchSetId": 29
      },
      "lineNbr": 38,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "nit: is there a `StorageManager` prefix missing here, and on `#deleteStorageArea` below?",
      "range": {
        "startLine": 38,
        "startChar": 23,
        "endLine": 38,
        "endChar": 39
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "07a9ae65_a3a2a965",
        "filename": "core/java/android/os/storage/StorageArea.java",
        "patchSetId": 29
      },
      "lineNbr": 38,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Yes, good catch",
      "parentUuid": "4da2f6df_b54e89a6",
      "range": {
        "startLine": 38,
        "startChar": 23,
        "endLine": 38,
        "endChar": 39
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7a4b7988_edda994c",
        "filename": "core/java/android/os/storage/StorageArea.java",
        "patchSetId": 29
      },
      "lineNbr": 43,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "can this be final?\n\n\u003e Favor composition over inheritance (go/ej3e-18)",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 43,
        "endChar": 51
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5fa71ea0_3ee61595",
        "filename": "core/java/android/os/storage/StorageArea.java",
        "patchSetId": 29
      },
      "lineNbr": 43,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Yes, this can be a `final` class. We anticipate that if specializations of StorageAreas are to be created, this will be on the Jetpack side, e.g., currently we only support unlocked-only storage areas with the planned Jetpack library, but there is potential for others in the future. These would all be wrappers around the underlying platform `StorageArea` class.",
      "parentUuid": "7a4b7988_edda994c",
      "range": {
        "startLine": 43,
        "startChar": 0,
        "endLine": 43,
        "endChar": 51
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "de33f904_851a55ff",
        "filename": "core/java/android/os/storage/StorageArea.java",
        "patchSetId": 29
      },
      "lineNbr": 96,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "nit: A very literal person could interpret this to mean that the **only** reason this method will throw `IOException` is if there are open files - but I suspect there could actually be other causes (though probably a lot less common)?\n\nIf I\u0027m right, then we can probably just flip the sentence slightly to something like:\n\n\u003e If the underlying storage area still has open files, this method may throw an {@link IOException}.",
      "range": {
        "startLine": 95,
        "startChar": 6,
        "endLine": 96,
        "endChar": 48
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c20f3881_a8f8e59e",
        "filename": "core/java/android/os/storage/StorageArea.java",
        "patchSetId": 29
      },
      "lineNbr": 96,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Good point.",
      "parentUuid": "de33f904_851a55ff",
      "range": {
        "startLine": 95,
        "startChar": 6,
        "endLine": 96,
        "endChar": 48
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e9c76b1b_8a097ada",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2964,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "optional: is there an existing DAC page you can link to here? so a reader can immediately jump off to check they understand what \u0027credential encrypted\u0027 means.",
      "range": {
        "startLine": 2964,
        "startChar": 69,
        "endLine": 2964,
        "endChar": 97
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6ed8b9fe_1943b3a0",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2964,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "I\u0027ve linked the general page about FBE here, which defines both CE and DE",
      "parentUuid": "e9c76b1b_8a097ada",
      "range": {
        "startLine": 2964,
        "startChar": 69,
        "endLine": 2964,
        "endChar": 97
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d16f6a7d_8a90de03",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2966,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "I defer to those more familiar with the actual feature here, but just checking what \u0027interacted with\u0027 means here? I would naively that means all reading and writing of files inside the storage area.\n\nHowever I understood from [your doc](https://docs.google.com/document/d/1UwZNApHnu2IbFXNnpsvlAQsaU8_mPUjFamCZQ4-NRcw/edit?pli\u003d1\u0026tab\u003dt.0) that only opening the storage area needs to happen while the device is unlocked, and any open storage areas are kept open when the device is locked? This part:\n\n\u003e Actions such as locking the device (if the Jetpack library is in use) have no effect on the open storage area; such checks only occur at opening time.",
      "range": {
        "startLine": 2965,
        "startChar": 42,
        "endLine": 2966,
        "endChar": 75
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "21a92a2b_937c6683",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2966,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "That\u0027s true -- I\u0027ve actually removed this sentence now, because it only applies to the StorageArea when it is opened through the Jetpack library with the UnlockedOnlyDeviceRequired keystore keys.",
      "parentUuid": "d16f6a7d_8a90de03",
      "range": {
        "startLine": 2965,
        "startChar": 42,
        "endLine": 2966,
        "endChar": 75
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f3076e1a_01984c5c",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2972,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "do you want to add a TODO here to come back and update with a more concrete signpost once the exact name/library of the jetpack part is decided?",
      "range": {
        "startLine": 2972,
        "startChar": 7,
        "endLine": 2972,
        "endChar": 35
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ca1cfa34_049b21db",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2972,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Good idea",
      "parentUuid": "f3076e1a_01984c5c",
      "range": {
        "startLine": 2972,
        "startChar": 7,
        "endLine": 2972,
        "endChar": 35
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0cac82e_8520c538",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2981,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "wording nit: wdyt about saying \u0027locked\u0027 here? (and elsewhere where you talk about the reference count decrementing to zero)",
      "range": {
        "startLine": 2981,
        "startChar": 24,
        "endLine": 2981,
        "endChar": 36
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b88989e8_412cc1b5",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2981,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Good idea, thats more consistent with the wording we\u0027re using in the doc now too.",
      "parentUuid": "a0cac82e_8520c538",
      "range": {
        "startLine": 2981,
        "startChar": 24,
        "endLine": 2981,
        "endChar": 36
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15da93de_348ab3c5",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2984,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "I assume CE \u003d Credential Encryption and DE \u003d Device Encryption\n\nneither have been explicitly defined so far in this javadoc, so I think we should probably just expand both to their unacronymned form.",
      "range": {
        "startLine": 2984,
        "startChar": 53,
        "endLine": 2984,
        "endChar": 92
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d7b61d49_6d59d10e",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2984,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Good point",
      "parentUuid": "15da93de_348ab3c5",
      "range": {
        "startLine": 2984,
        "startChar": 53,
        "endLine": 2984,
        "endChar": 92
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "06916800_605aec15",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2986,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "nit: the type of the parameter will be automatically clear in the rendered HTML, so you can just focus on the length here. Something like:\n\n\u003e this must be 32 bytes long",
      "range": {
        "startLine": 2985,
        "startChar": 84,
        "endLine": 2986,
        "endChar": 35
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "95f914f9_a095dfbb",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2986,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "06916800_605aec15",
      "range": {
        "startLine": 2985,
        "startChar": 84,
        "endLine": 2986,
        "endChar": 35
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd4a7ffd_306a1a80",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2993,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "you can annotate this with `@Size(max\u003d128)` and `secret` with `@Size(32)`\n\nhttps://developer.android.com/studio/write/annotations#value-constraint\n\nhttps://developer.android.com/reference/androidx/annotation/Size\n\n---\n\nRelated: Is an empty `storageAreaName` allowed?",
      "range": {
        "startLine": 2993,
        "startChar": 39,
        "endLine": 2993,
        "endChar": 70
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "936c3942_fbfde398",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 2993,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Nice, thanks! I was not aware of these annotations.\nAlso: empty `storageAreaName` is not allowed; I\u0027ve added a `min\u003d1` constraint on it too.",
      "parentUuid": "cd4a7ffd_306a1a80",
      "range": {
        "startLine": 2993,
        "startChar": 39,
        "endLine": 2993,
        "endChar": 70
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "586422bd_68807dee",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 3026,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "nit (and a little outside API): this is the first usage of `storageAreaName` and it occurs before you\u0027ve null-checked it, which means this will append `\"_null\"` to the string\n\nTo avoid a future reader wondering what happens next, maybe just put explicit null, size (and valid char?) checks for both `storageAreaName` and `secret` right at the top of this method?",
      "range": {
        "startLine": 3026,
        "startChar": 0,
        "endLine": 3026,
        "endChar": 91
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e081a9a7_1e0ab7ff",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 3026,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Makes sense -- I added a `null` and length check on `storageAreaName`.\nThe valid character check happens inside of `StorageManagerService`\u0027s `openStorageArea` already, so if it\u0027s invalid an error will be thrown from there.",
      "parentUuid": "586422bd_68807dee",
      "range": {
        "startLine": 3026,
        "startChar": 0,
        "endLine": 3026,
        "endChar": 91
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "20022fc0_fdfdf5be",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 3064,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "I could be misunderstanding, but I think (?) the guidance here should be:\n\n1. If you used Jetpack to create your storage area, use Jetpack to delete it\n2. If you created your storage area directly with StorageManager (which itself is discouraged), you can delete it directly with this StorageManager method\n\nThese docs as worded seem to suggest that Jetpack should be used even in case (2) - but that seems a bit surprising.",
      "range": {
        "startLine": 3061,
        "startChar": 0,
        "endLine": 3064,
        "endChar": 25
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e216f18e_5205eaa8",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 3064,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Good point -- you\u0027re right about the intended message here.",
      "parentUuid": "20022fc0_fdfdf5be",
      "range": {
        "startLine": 3061,
        "startChar": 0,
        "endLine": 3064,
        "endChar": 25
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "20681cb0_2f8a6f56",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 3073,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2024-04-25T07:38:34Z",
      "side": 1,
      "message": "same eager null check suggestion here, because I think passing `null` here atm might throw `NoSuchElementException` instead of `NullPointerException`?",
      "range": {
        "startLine": 3073,
        "startChar": 0,
        "endLine": 3073,
        "endChar": 68
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c10dfa0f_a192f05c",
        "filename": "core/java/android/os/storage/StorageManager.java",
        "patchSetId": 29
      },
      "lineNbr": 3073,
      "author": {
        "id": 1954616
      },
      "writtenOn": "2024-04-25T22:44:31Z",
      "side": 1,
      "message": "Sounds good; added. I left out the `@Size` constraint on the `storageAreaName` that we have in the `openStorageArea` method, because I think the `FileNotFoundException` makes more sense for trying to delete with an invalid name.",
      "parentUuid": "20681cb0_2f8a6f56",
      "range": {
        "startLine": 3073,
        "startChar": 0,
        "endLine": 3073,
        "endChar": 68
      },
      "revId": "15aca2306d8ce2f11312b83a2ba521d3da1cfab7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}