{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "3b84f423_fdb5eda3",
        "filename": "services/core/java/com/android/server/ConnectivityService.java",
        "patchSetId": 12
      },
      "lineNbr": 2810,
      "author": {
        "id": 1015428
      },
      "writtenOn": "2020-11-25T04:37:49Z",
      "side": 1,
      "message": "Did you want to keep the `break;` though",
      "range": {
        "startLine": 2810,
        "startChar": 19,
        "endLine": 2810,
        "endChar": 21
      },
      "revId": "0dd3d69885bb426ce3a3c4195b592fb04e790d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7521295c_d90af2a3",
        "filename": "services/core/java/com/android/server/ConnectivityService.java",
        "patchSetId": 12
      },
      "lineNbr": 2810,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2020-11-25T07:16:33Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3b84f423_fdb5eda3",
      "range": {
        "startLine": 2810,
        "startChar": 19,
        "endLine": 2810,
        "endChar": 21
      },
      "revId": "0dd3d69885bb426ce3a3c4195b592fb04e790d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "860faf02_79d1df51",
        "filename": "services/core/java/com/android/server/connectivity/Vpn.java",
        "patchSetId": 12
      },
      "lineNbr": 1863,
      "author": {
        "id": 1015428
      },
      "writtenOn": "2020-11-25T04:54:02Z",
      "side": 1,
      "message": "A bit late here but I think we should disallow this.\nIn https://android-review.googlesource.com/c/platform/frameworks/base/+/1501816/15/services/core/java/com/android/server/ConnectivityService.java#4724 the new code will crash the system server if one element of the Network array is null (while before it used to silently ignore it). I don\u0027t think that ignoring it is great policy.\n\nI see two options then, to keep backward compatibility : either this code here removes nulls, or we continue to ignore null underlying networks in CS#createVpnInfo. I think the former is a better solution, even though it\u0027s a bit annoying for the size of the array here.",
      "range": {
        "startLine": 1863,
        "startChar": 20,
        "endLine": 1863,
        "endChar": 57
      },
      "revId": "0dd3d69885bb426ce3a3c4195b592fb04e790d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c6008e9a_03e72669",
        "filename": "services/core/java/com/android/server/connectivity/Vpn.java",
        "patchSetId": 12
      },
      "lineNbr": 1863,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2020-11-25T07:16:33Z",
      "side": 1,
      "message": "I\u0027ve fixed the crash in aosp/1501816 by calling getNetworkAgentInfoForNetwork instead of getNetworkAgentInfoForNetId. We might still want to do this. Perhaps not in this CL, though, so we can test that there are actually no implications?",
      "parentUuid": "860faf02_79d1df51",
      "range": {
        "startLine": 1863,
        "startChar": 20,
        "endLine": 1863,
        "endChar": 57
      },
      "revId": "0dd3d69885bb426ce3a3c4195b592fb04e790d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab7ccf03_5c2c8a0b",
        "filename": "services/core/java/com/android/server/connectivity/Vpn.java",
        "patchSetId": 12
      },
      "lineNbr": 1869,
      "author": {
        "id": 1015428
      },
      "writtenOn": "2020-11-25T04:37:49Z",
      "side": 1,
      "message": "So IIUC this should never happen, right ? Or maybe it does in the test ?\n\nVpnService clients can\u0027t call this before calling `establish()` :\n\n  setUnderlyingNetworks\n  [...]\n  This call will succeed only if the VPN is currently established. For setting this value when \n  the VPN has not yet been established, see Builder#setUnderlyingNetworks.",
      "range": {
        "startLine": 1869,
        "startChar": 12,
        "endLine": 1869,
        "endChar": 33
      },
      "revId": "0dd3d69885bb426ce3a3c4195b592fb04e790d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6bb72cef_7c6dbf77",
        "filename": "services/core/java/com/android/server/connectivity/Vpn.java",
        "patchSetId": 12
      },
      "lineNbr": 1869,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2020-11-25T07:16:33Z",
      "side": 1,
      "message": "Yes, mNetworkAgent can never be null here. This method is synchronized on the class lock which also protects mNetworkAgent. And the first thing the method does is call isCallerEstablishedOwnerLocked, which returns false if mNetworkAgent \u003d\u003d null. Removed.",
      "parentUuid": "ab7ccf03_5c2c8a0b",
      "range": {
        "startLine": 1869,
        "startChar": 12,
        "endLine": 1869,
        "endChar": 33
      },
      "revId": "0dd3d69885bb426ce3a3c4195b592fb04e790d0c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}