{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "1f5d6273_88192285",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1725686
      },
      "writtenOn": "2020-12-09T08:28:11Z",
      "side": 1,
      "message": "The proposed change causes HdmiControlService to be in POWER_STATUS_STANDBY after a regular boot, even though the device is awake. That is not desired.",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "56c2557c_766faa8b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1501832
      },
      "writtenOn": "2021-01-07T09:09:46Z",
      "side": 1,
      "message": "We agree with this point.\nThe root cause of this issue is that initializeCec() being called twice when first boot up, in onStart() and onWakeup() respectively.\nSince calling onWakeup() is necessary for both boot up and DC resume.\nIs it okay that we simply remove calling initializeCec() in onStart()?",
      "parentUuid": "1f5d6273_88192285",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25c235e3_52032632",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1725686
      },
      "writtenOn": "2021-01-07T14:26:24Z",
      "side": 1,
      "message": "That would break quiescent boot.\n\nFor quiescent boot, initializeCec() is only called once, in onStart(). onWakeUp() is not called. The proposed change would mean not initializing CEC on quiescent boot.",
      "parentUuid": "56c2557c_766faa8b",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52fd956c_ce5d4f89",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1501832
      },
      "writtenOn": "2021-01-12T06:05:44Z",
      "side": 1,
      "message": "In current flow, initializeCec() is called twice with normal boot.\n1. onStart() -\u003e initializeCec()\n2. onBootPhase() -\u003e bootCompleted() -\u003e onWakeup()) -\u003e initializeCec()\n\nIn the case of quiescent boot, is onBootPhase() triggered? \nIf so, it should be okay to skip initializeCec in onStart() (1. above).\nIf not, could we use a flag to prevent initializeCec() from being called twice?",
      "parentUuid": "25c235e3_52032632",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6a7b09fc_82b22df1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1725686
      },
      "writtenOn": "2021-01-12T08:45:38Z",
      "side": 1,
      "message": "onBootPhase() and bootCompleted() are triggered on quiescent boot but don\u0027t result in onWakeUp() and initializeCec(). Therefore skipping initializeCec in 1. won\u0027t work.\nUsing a flag can work but is not trivial:\n- in 2., initializeCec is used to move from POWER_STATUS_TRANSIENT_TO_ON to POWER_STATUS_ON. If the flag suppresses initializeCec, we would need to perform that power state change somewhere else. \n- Alternatively, initializeCec can still be invoked but the flag suppresses the messages and HdmiCecFeatureActions on the 2nd stage of boot.",
      "parentUuid": "52fd956c_ce5d4f89",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1c99a9f4_30d7d22b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1501832
      },
      "writtenOn": "2021-01-13T11:44:33Z",
      "side": 1,
      "message": "Thanks for the explanation.\nWe revisit the flow of normal boot and quiescent boot, and we think that it should be fine to simply modify the power status to POWER_STATUS_ON in bootCompleted().\nWith this modification, local device is initiated only once on normal boot.\n\nHowever, for quiescent boot, initializeCec() would still be called twice.\nWe have to suppress HdmiCecFeatureActions as well.\n\nNote that we also add logic to bypass \u003cDevice Vendor ID\u003e and \u003cReport Power Status\u003e when HdmiControlService is in standby mode, for processing DeviceDiscoveryAction on quiescent boot.",
      "parentUuid": "6a7b09fc_82b22df1",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e2de8b30_0f2ec003",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1725686
      },
      "writtenOn": "2021-02-03T13:53:26Z",
      "side": 1,
      "message": "* just changing power status to POWER_STATUS_ON in bootComplete() seems reasonable. Robert, when this was implemented, was there any particular reason to go through onWakeUp()?\n* on quiescent boot, initializeCec() is only called once, already today. Can you provide more context on the test? If initializeCec() is only called once, is suppressing the HdmiCecFeatureActions and bypassing the CEC messages unnecessary?",
      "parentUuid": "1c99a9f4_30d7d22b",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "41069f41_4663e329",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1468761
      },
      "writtenOn": "2021-02-03T15:33:00Z",
      "side": 1,
      "message": "\u003e Robert, when this was implemented, was there any particular reason to go through onWakeUp()?\n\nIt seemed to be the way to change power state to ON, as it is also called ACTION_SCREEN_ON.\nTo better understand, is `onWakeUp` on `ACTION_SCREEN_ON` okay because `onStandby` calls `disableDevices`, so calling \"`initializeCec`\" is safe on next wakeup?\n\nI don\u0027t insist on going through onWakeUp / calling initializeCec again.\nIf just changing the power status to POWER_STATUS_ON directly is enough, that\u0027s fine by me.\nDoes that change in power status need to be broadcast though?",
      "parentUuid": "e2de8b30_0f2ec003",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "627bcf29_2f1a6bb7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1725686
      },
      "writtenOn": "2021-02-04T17:28:16Z",
      "side": 1,
      "message": "Thanks for having a look! `onWakeUp` on `ACTION_SCREEN_ON` is okay because CEC needs to be initialized at that time. It had been deactivated onStandby.\nOn boot however, CEC had already been initialized.\n\nIn that case it is fine to remove the second call to onWakeUp.",
      "parentUuid": "41069f41_4663e329",
      "revId": "91dee8b04c79525ce555295e6cd380e80c948f1f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}